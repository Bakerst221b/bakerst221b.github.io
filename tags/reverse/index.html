<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reverse - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/tags/reverse/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    

    
    



 
 <h1 class="title">Reverse</h1> 
 

    <h2><a href="https://bakerst221b.com/docs/attacks/binary/exploits/bufferoverflow/overview/"> Overview</a></h2> 
    <p> <p><em>The idea of a buffer overflow attack is quite simple, though the implementation might initially be difficult to digest. I am exploring this notion and visualising it in this article.</em> <!-- more --></p>
<h2 id="mechanics">Mechanics</h2>
<p>Imagine you have a job you don&rsquo;t really like (I think most of us have had such an experience at least once in our life ğŸ˜¢). And also, imagine that you are being highly underpaid. Your job is simple and ridiculous: place rabbits ğŸ‡ into one set of boxes and foxes ğŸ¦Š - into another. You happen to have 6 boxes ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ for foxes ğŸ¦Š and 4 ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ for rabbits ğŸ‡. However, you were given 4 rabbits ğŸ‡ğŸ‡ğŸ‡ğŸ‡ and 7 foxes ğŸ¦ŠğŸ¦ŠğŸ¦ŠğŸ¦ŠğŸ¦ŠğŸ¦ŠğŸ¦Š. So, one fox ğŸ¦Š doesn&rsquo;t have its fox box ğŸ“¦. However, there are also rabbit ğŸ‡ boxes ğŸ“¦ right nearby. So, even though you were explicitly told not to place foxes into rabbit boxes and vice versa since you don&rsquo;t give a shit, you put a fox into a rabbit fox. What happens? One can only guess&hellip; ğŸ¤”. Long story short: the fox eats the rabbit, and now you have 7 foxes and only 3 rabbits ğŸ‡. Alas! If only you&rsquo;d followed the manual ğŸ“–&hellip;. Most likely, one would get fired after such a mistake, but we can&rsquo;t fire the compiler, so that would happen if the developer was not using a memory-safe language or wasn&rsquo;t careful enough. Now, to the technicalities.</p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/binary/exploits/bin/"> Binary Vulnerabilities And Exploits</a></h2> 
    <p> <p><em>In this article I will collect common binary vulnerability (expept for the bufferoverflow which has its own dedicated article) &hellip; .</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/artefacts/files/executables/macho/"> Apple Mach-O</a></h2> 
    <p> <h2 id="binary-info">Binary info</h2>
<h3 id="otool">otool</h3>
<p>Using <code>otool</code> we can get general info about the Mach-O file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>otool -h <span style="color:#f92672">[</span>app_name<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Mach header
</span></span><span style="display:flex;"><span>      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
</span></span><span style="display:flex;"><span> 0xfeedfacf <span style="color:#ae81ff">16777228</span>          <span style="color:#ae81ff">0</span>  0x00           <span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">115</span>      <span style="color:#ae81ff">11384</span> 0x00218085
</span></span></code></pre></div><p>Quick refernce on the meaning:</p>
<p>32-bit (ARMv6, ARMv7) â€“ <code>0xFEEDFACE</code>
64-bit â€“ <code>0xFEEDFACF</code>
Universal binaries â€“ <code>0xCAFEBABE</code></p>
<h3 id="robin2">robin2</h3>
<h3 id="nm">nm</h3>
<p><code>nm WindTail/Final_Presentation.app/Contents/MacOS/usrnode</code> - view the APIs used.
SMLoginItemSetEnabled - Wardle, Patrick. The Art of Mac Malware (p. 25). No Starch Press. Kindle Edition.</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/malware/analyse/executables/macho/"> Apple Mach-O</a></h2> 
    <p> <h2 id="binary-info">Binary info</h2>
<h3 id="otool">otool</h3>
<p>Using <code>otool</code> we can get general info about the Mach-O file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>otool -h <span style="color:#f92672">[</span>app_name<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Mach header
</span></span><span style="display:flex;"><span>      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
</span></span><span style="display:flex;"><span> 0xfeedfacf <span style="color:#ae81ff">16777228</span>          <span style="color:#ae81ff">0</span>  0x00           <span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">115</span>      <span style="color:#ae81ff">11384</span> 0x00218085
</span></span></code></pre></div><p>Quick refernce on the meaning:</p>
<p>32-bit (ARMv6, ARMv7) â€“ <code>0xFEEDFACE</code>
64-bit â€“ <code>0xFEEDFACF</code>
Universal binaries â€“ <code>0xCAFEBABE</code></p>
<h3 id="robin2">robin2</h3>
<h3 id="nm">nm</h3>
<p><code>nm WindTail/Final_Presentation.app/Contents/MacOS/usrnode</code> - view the APIs used.
SMLoginItemSetEnabled - Wardle, Patrick. The Art of Mac Malware (p. 25). No Starch Press. Kindle Edition.</p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/binary/exploits/dev/"> Exploit Development</a></h2> 
    <p> <h2 id="process">Process</h2>
<h3 id="steps-overview">Steps Overview</h3>
<ol>
<li>Fuzz and fins unusual behaviour</li>
<li>Detect any possibility to overwrite crucial parts:
<ol>
<li>EIP</li>
<li>SEH</li>
<li>Acces violations/invalid memory addresses</li>
<li>etc</li>
</ol>
</li>
<li>Hijack Execution</li>
<li>Eliminate bad characters</li>
<li>Write PoC, spawning a reverse or bind shell, RAT or move to other systems.</li>
</ol>
<h3></h3>
<h3 id="bad-characters">Bad Characters</h3>
<p>All characters from 0 to 255 (decimal) represented in a hex format like this: <code>/0x00/0x01...</code>.</p>
<h2 id="-rtfm">ğŸ“• RTFM</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msf-pattern_create -l <span style="color:#ae81ff">1400</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;POST&#34;</span><span style="color:#66d9ef">$(</span>mapstr<span style="color:#66d9ef">)</span> | nc -nv 127.0.0.1:8080
</span></span><span style="display:flex;"><span>msf-pattern_offset -q &lt;part of mapstr in EIP&gt;
</span></span></code></pre></div><p><a href="http://docs.pwntools.com/en/stable/index.html">http://docs.pwntools.com/en/stable/index.html</a> and an example of use - <a href="https://www.megabeets.net/a-journey-into-radare-2-part-2/">https://www.megabeets.net/a-journey-into-radare-2-part-2/</a>.</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/malware/analyse/basics/c-prog-memory-layout/"> Proccess Memory Layout</a></h2> 
    <p> <h2 id="intro">Intro</h2>
<p>At the very beginning of my career I found it hard to grasp the notion of memory layout and stack. Even when I read about it several times, it didn&rsquo;t feel solid. That&rsquo;s why I drew drew and drew. Because my mind prefers pictures, analogies, metaphors and examples! So, I&rsquo;ve made that. May be someone finds it useful.</p>
<h2 id="picture">Picture</h2>
<p><img src="images/memoryLayoutC.png" alt="memoryLayoutC"></p>
<h2 id="metaphor-and-analogy">Metaphor and Analogy</h2>
<p>I was thinking about a good metaphor, but that was the extent of my imagination&hellip; Let&rsquo;s say some weirdo (let&rsquo;s call him Gargaralian) is piling up all the boring books he has &#x1f4da; under the table because the appartment is too small and the luxury of having a bookcase is not an option available for him. Besides, the table is a little loose, so that pile of books could be like the fifth leg. Something like that:</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/malware/analyse/basics/compilation-and-linking/"> Compilation and Linking ğŸ”—</a></h2> 
    <p> <p><em>In this article I am trying to reasearch compilation and linking process.</em></p>
<h2 id="terms">Terms</h2>
<p><code>.cpp</code> - is a human-readable file written in any programming language. In this example it&rsquo;s a file written in C++. An example of this file (meaningless for simplicity sake):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> a, b, c; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>.obj</code>,  <code>.coff</code> - binary file with its own structure. 1 file of source code (<code>*.cpp</code>) is compiled into 1 <code>.obj</code> or <code>.coff</code> file. Consists of sections, symbol table (name and current location of variable or function that can be referenced by other object files), relocation table (addresses referenced in this file that the linker must adjust when it knows the final memory layout) and debug info. A header that says where in the files the sections below are located ï‚¨ A (concatenated) text segment, which contains all the source code (with some missing addresses) ï‚¨ A (concatenated) data segment (which combines all data and the bss segments)</p></p>

    <h2><a href="https://bakerst221b.com/docs/tools/exploit-env/"> Exploit Development Env</a></h2> 
    <p> <p><em>This is about &hellip; .</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/blog/2021/08/lord-of-the-apple/"> The Lord of the Apple: The Return of the iPhone</a></h2> 
    <p> <p>ğŸ“† <code>22/08/2021</code> , <em>Sunday</em>, â˜ï¸</p>
<p>ğŸ•° <code>11:21 AM</code>.</p>
<p>It was a cloudy Sunday morning. I was sleeping peacefully till 8:45 AM when my daughter started crawling all over me and my husband asking wether I am awake already&hellip; . Well, now I am, darling, many thanks ğŸ¤¦ğŸ»â€â™€ï¸! After having a delicious breakfast (eggplants with home-made tomato sauce, yummy ğŸ˜‹) and getting the kitchen back to the clean state (it&rsquo;s very hard to keep it that way), I&rsquo;ve decided to finally repair my little old fellow iPhone 7. Several weeks ago I went on vocation to Cyprus and broke the rare camera glass and the screen as well, because I somehow managed to drop the phone on the pavement 3 â—ï¸times! To be honest, these were not the first times when my iPhone met some surface harder than my palm, so it&rsquo;s a miracle this had not happened before.</p></p>

    <h2><a href="https://bakerst221b.com/docs/blog/2021/06/magnet/"> To Carry Out MockInv&#39;estigation. Part 2</a></h2> 
    <p> <p>ğŸ“† <code>16/06/2021</code> , <em>Wednesday</em></p>
<p>ğŸ•° <code>09:21 PM</code>.</p>
<p><em>I had a 7-day license of Magnet AXIOM and I&rsquo;ve decided to try this tool and compare it with others that I had. In 2021 May-June Magnet held a great event of a great value - Magnet SUMMIT with lots of very useful webinars and workshops. One of them was a case study using Magnet. I am going to follow these steps and study another way to solve a crime.</em></p></p>





<style>
    body {
    color: #212121;
}

h2 {
    font-weight: bold;
    
}

 
 
 
.pagination {
    display: flex;
    list-style: none;
    border-radius: .25rem;
    margin: 20px 0;
    padding: 0;
    justify-content: center;
}

.page-link {
    position: relative;
    display: block;
    padding: .75rem 1rem;
    margin-left: -1px;
    line-height: 1.25;
    color: #2bbc8a;
    background-color: #fff;
}

.homepage .page-link,
.listing .page-link {
    background-color: #fff;
}

.page-item.disabled .page-link {
    color: #6c757d;
    pointer-events: none;
    cursor: auto;
    background-color: #fff;
    border-color: #dee2e6;
}

.page-item.active .page-link {
    z-index: 1;
    color: #fff;
    background-color: #2bbc8a;;
    border-color:#2bbc8a;
    border-radius: 30px;
}

</style>
<nav aria-label="page navigation">
    <ul class="pagination">
        
        

        

        
             
            <li class="page-item active"><a href="/tags/reverse/" class="page-link">1</a></li>
            
        
            
             
            <li class="page-item"><a href="/tags/reverse/page/2/" class="page-link">2</a></li>
            
        
            
             
            <li class="page-item"><a href="/tags/reverse/page/3/" class="page-link">3</a></li>
            
        

        
        <li class="page-item"><a href="/tags/reverse/page/2/" rel="next" class="page-link">Next â€º</a></li>
        

        
        
        <li class="page-item"><a href="/tags/reverse/page/3/" rel="last" class="page-link">Last Â»</a></li>
        
    </ul>
</nav>


    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/tags/reverse/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
