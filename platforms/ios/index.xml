<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ios on Analyst</title>
    <link>https://bakerst221b.com/platforms/ios/</link>
    <description>Recent content in Ios on Analyst</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 25 Apr 2021 17:18:04 +0300</lastBuildDate>
    <atom:link href="https://bakerst221b.com/platforms/ios/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Apple Partition Map</title>
      <link>https://bakerst221b.com/docs/artefacts/fs/partiation-schemas/apm/</link>
      <pubDate>Tue, 06 Oct 2020 09:39:12 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/fs/partiation-schemas/apm/</guid>
      <description>&lt;p&gt;APFS is not very much described from the forensic perspective. I wonder how much APM is described.&lt;/p&gt;&#xA;&lt;p&gt;APM and APFS seem to be unable to live together. APFS requires GUID.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìö MacOS Basics</title>
      <link>https://bakerst221b.com/docs/todo/old/defences/macos-fundamentals/</link>
      <pubDate>Mon, 28 Sep 2020 13:21:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/todo/old/defences/macos-fundamentals/</guid>
      <description>&lt;h2 id=&#34;firewall&#34;&gt;Firewall&lt;/h2&gt;&#xA;&lt;p&gt;You can set specific rules to limit the traffic.&lt;/p&gt;&#xA;&lt;h2 id=&#34;filevault&#34;&gt;FileVault&lt;/h2&gt;&#xA;&lt;p&gt;No recovery once this password is lost.&lt;/p&gt;&#xA;&lt;h2 id=&#34;partitions&#34;&gt;Partitions&lt;/h2&gt;&#xA;&lt;p&gt;It has a hidden partition installed (MacOS recovery). It replaces the installation disks that came with older PCs. Restart and hold down the &lt;code&gt;R&lt;/code&gt;-key. It doesn&amp;rsquo;t touch the user directories, only reinstalls the OS. If this option is not available, Internet recovery will be launched.&lt;/p&gt;&#xA;&lt;h2 id=&#34;disk-utility&#34;&gt;Disk Utility&lt;/h2&gt;&#xA;&lt;p&gt;When erasing data choose from the three options:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Apple Mach-O</title>
      <link>https://bakerst221b.com/docs/artefacts/files/executables/macho/</link>
      <pubDate>Mon, 28 Sep 2020 13:21:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/files/executables/macho/</guid>
      <description>&lt;h2 id=&#34;binary-info&#34;&gt;Binary info&lt;/h2&gt;&#xA;&lt;h3 id=&#34;otool&#34;&gt;otool&lt;/h3&gt;&#xA;&lt;p&gt;Using &lt;code&gt;otool&lt;/code&gt; we can get general info about the Mach-O file:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;otool -h &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;app_name&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Mach header&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 0xfeedfacf &lt;span style=&#34;color:#ae81ff&#34;&gt;16777228&lt;/span&gt;          &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;  0x00           &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;   &lt;span style=&#34;color:#ae81ff&#34;&gt;115&lt;/span&gt;      &lt;span style=&#34;color:#ae81ff&#34;&gt;11384&lt;/span&gt; 0x00218085&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Quick refernce on the meaning:&lt;/p&gt;&#xA;&lt;p&gt;32-bit (ARMv6, ARMv7) ‚Äì &lt;code&gt;0xFEEDFACE&lt;/code&gt;&#xA;64-bit ‚Äì &lt;code&gt;0xFEEDFACF&lt;/code&gt;&#xA;Universal binaries ‚Äì &lt;code&gt;0xCAFEBABE&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;robin2&#34;&gt;robin2&lt;/h3&gt;&#xA;&lt;h3 id=&#34;nm&#34;&gt;nm&lt;/h3&gt;&#xA;&lt;p&gt;&lt;code&gt;nm WindTail/Final_Presentation.app/Contents/MacOS/usrnode&lt;/code&gt; - view the APIs used.&#xA;SMLoginItemSetEnabled - Wardle, Patrick. The Art of Mac Malware (p. 25). No Starch Press. Kindle Edition.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Apple Mach-O</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/executables/macho/</link>
      <pubDate>Mon, 28 Sep 2020 13:21:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/executables/macho/</guid>
      <description>&lt;h2 id=&#34;binary-info&#34;&gt;Binary info&lt;/h2&gt;&#xA;&lt;h3 id=&#34;otool&#34;&gt;otool&lt;/h3&gt;&#xA;&lt;p&gt;Using &lt;code&gt;otool&lt;/code&gt; we can get general info about the Mach-O file:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;otool -h &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;app_name&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Mach header&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 0xfeedfacf &lt;span style=&#34;color:#ae81ff&#34;&gt;16777228&lt;/span&gt;          &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;  0x00           &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;   &lt;span style=&#34;color:#ae81ff&#34;&gt;115&lt;/span&gt;      &lt;span style=&#34;color:#ae81ff&#34;&gt;11384&lt;/span&gt; 0x00218085&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Quick refernce on the meaning:&lt;/p&gt;&#xA;&lt;p&gt;32-bit (ARMv6, ARMv7) ‚Äì &lt;code&gt;0xFEEDFACE&lt;/code&gt;&#xA;64-bit ‚Äì &lt;code&gt;0xFEEDFACF&lt;/code&gt;&#xA;Universal binaries ‚Äì &lt;code&gt;0xCAFEBABE&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;robin2&#34;&gt;robin2&lt;/h3&gt;&#xA;&lt;h3 id=&#34;nm&#34;&gt;nm&lt;/h3&gt;&#xA;&lt;p&gt;&lt;code&gt;nm WindTail/Final_Presentation.app/Contents/MacOS/usrnode&lt;/code&gt; - view the APIs used.&#xA;SMLoginItemSetEnabled - Wardle, Patrick. The Art of Mac Malware (p. 25). No Starch Press. Kindle Edition.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üçé iOS Evidence Collection</title>
      <link>https://bakerst221b.com/docs/todo/old/defences/ios/</link>
      <pubDate>Mon, 12 Oct 2020 17:50:01 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/todo/old/defences/ios/</guid>
      <description>&lt;h2 id=&#34;general-considerations&#34;&gt;General Considerations&lt;/h2&gt;&#xA;&lt;p&gt;First of all, all the Apple devices support remote wiping which has evolved significantly over the year and now support Bluetooth. When I say wiping over Bluetooth, it doesn&amp;rsquo;t mean that the person wiping and the device need to be in the Bluetooth range (which is quite short). It could be an examiner with a Bluetooth enabled standing near the iPhone with Bluetooth on and the person of interest somewher within the range of the first responder. I didn&amp;rsquo;t try this myself, but I should. This is based on the interview given on the Surviving Digital Forensics podcast on T1 and T2 Apple devices and the challenges the forensic examiners now face.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Apple Platform Security</title>
      <link>https://bakerst221b.com/docs/artefacts/apple/apple-security/</link>
      <pubDate>Thu, 17 Sep 2020 12:18:10 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/apple/apple-security/</guid>
      <description>&lt;p&gt;&lt;em&gt;Applications or even OS itself doesn&amp;rsquo;t know the keys that are protected by Secure Enclave. OS only sees Keychain, but the Security Enclave is separated. It&amp;rsquo;s asked to decrypt the information and it does just that returning the decrypted information.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;hardware&#34;&gt;Hardware&lt;/h2&gt;&#xA;&lt;p&gt;Imagine that there lives a vicious criminal ü¶π who&amp;rsquo;s stealing and deleting puppy photos from a preschool server. It&amp;rsquo;s a nasty bussiness that can get him in jail if he&amp;rsquo;s not cautious. He likes to keep everything on the mobile phone he has with him all the time even in the bathroom üöΩ and while taking a shower üöø (he&amp;rsquo;s very careful). He considers the photos to be completely safe since he has set up a PIN for the device only he knows. All his secrets and stuff that can potentially throw him into jail are all on this little piece of harware.&lt;/p&gt;&#xA;&lt;p&gt;But suddenly some other guy rats üêÄ him out (because he is sure that&amp;rsquo;s beneath his dignity to do such a damage for little kids) and serious and righteous people in suits are comming to your home with a warrant üìÑ. Well, this criminal ü¶π‚Äç‚ôÄÔ∏è  still thinks: &amp;ldquo;&lt;em&gt;Hey, suckers, I&amp;rsquo;ve got everything on my mobile phone which is secure as hell. All other devices are completely wiped.&lt;/em&gt;&amp;rdquo;. How wrong would this assumption be? What if he had an old Android device? Or may be a iPhone 5S? Or iPhone 4? Is there really a difference? What if the only reasonable assumption in this case would be for him to pack ciggies üö¨  for the jail?&lt;/p&gt;&#xA;&lt;p&gt;One of the main things to think about when answering the question: is the mobile phone&amp;rsquo;s NAND or NOR (i.e. non-volatile storage) encrypted? If it&amp;rsquo;s not, then, my dear fellow, he is in trouble. One could just extract this precious little chip and insert it into another device. Now they don&amp;rsquo;t need &lt;em&gt;his&lt;/em&gt; passcode, they&amp;rsquo;d only require theirs or even none at all.&lt;/p&gt;&#xA;&lt;p&gt;Alright, say, he was not complete dump and was smart enough to get himself a deviceüì±that uses fulldisk encryption. Is this attack still feseable? Well, depends on where the key üîë is stored. If it&amp;rsquo;s, for example, stored at &lt;code&gt;0x0000000&lt;/code&gt; address of this NAND, then it&amp;rsquo;s just the question of extracting this chip, reading üìñ the first bytes and decrypting the contents. So, how and where to store this key in order to make this &lt;em&gt;at least&lt;/em&gt; harder?&lt;/p&gt;&#xA;&lt;p&gt;This is what Apple has been doing for a while. It got so overwhelmed with this task that it happened to end up protecting its endusers even from themselves.&lt;/p&gt;&#xA;&lt;p&gt;Back then mobile devices had several basic parts: CPU, some storage chip (NAND or NOR) and some other pieces used to make it possible to use this for talking and SMS-ing. Apple has decided to apply the least-privilege policy here again and restrict the enduser to only those tasks he or she can possibly want to do. It&amp;rsquo;s a phone afterall. Why modifying OS? You don&amp;rsquo;t need it. Make you calls and be happy.&lt;/p&gt;&#xA;&lt;p&gt;Modern Apple iDevices have two AES engines: one is for Secure Enclave only, another one is used both for SE and Application Processor.&lt;/p&gt;&#xA;&lt;h2 id=&#34;intro&#34;&gt;Intro&lt;/h2&gt;&#xA;&lt;p&gt;When the device is manufactured, a 256-bit AES key is written to Secure Enclave. Before some veresions of Apple devices these UIDs were randomly generated and them fused to the chip. However at the moment they are generated by SE during manufacturing and fused using special software. There is no API (neither software, nor hardware) that is able to get it from there, used only by the processor‚Äôs hardware AES engine. This UID key is unique for each device.&lt;/p&gt;&#xA;&lt;p&gt;Also, when user creates a passcode, it is turned into a cryptographic key and strengthened with the device‚Äôs UID.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PBKDF2&lt;/span&gt;(user_pass_derived_crypto_key, device_uid):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;aes_key &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; device_uid&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,n):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    result &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pseudorandom_func(aes, aes_key, result, user_pass_derived_crypto_key)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;   &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user_passcode &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;secret&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;device_uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;123456...0&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user_pass_derived_crypto_key &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; crypto(user_passcode)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;se_mem_key &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; PBKDF2(user_pass_derived_crypto_key, device_uid)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;se_mem_key&lt;/code&gt; encrypts Secure Enclave&amp;rsquo;s memory space.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In iOS and iPadOS, files are encrypted with a key entangled with the Secure Enclave‚Äôs UID and an anti-replay nonce as they are written to the data volume. On A9 (and newer) SoCs, the anti-replay nonce uses entropy generated by the hardware random number generator. The anti-replay nonce support is rooted in a dedicated nonvolatile memory &lt;a href=&#34;https://support.apple.com/guide/security/aside/sec3256b5f8c/1/web/1&#34;&gt;integrated circuit (IC)&lt;/a&gt;. In Mac computers with the Apple T2 Security Chip, the FileVault key hierarchy is similarly linked to the UID of the Secure Enclave. In devices with A12 (and newer) and S4 SoCs, the Secure Enclave is paired with a secure storage IC for anti-replay nonce storage. The secure storage IC is designed with immutable ROM code, a hardware random number generator, cryptography engines, and physical tamper detection. To read and update nonces, the Secure Enclave and storage IC employ a secure protocol that ensures exclusive access to the nonces.&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://support.apple.com/guide/security/dedicated-aes-engine-sec4ea70a303/1/web/1&#34;&gt;https://support.apple.com/guide/security/dedicated-aes-engine-sec4ea70a303/1/web/1&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;All this resembles the sad story of a businessman from &lt;em&gt;Eine Woche volle Samstage (1973)&lt;/em&gt; by Paul Maar, when a man was so afraid üò± of thieves ü¶π‚Äç‚ôÄÔ∏è that he hid the office key üîë in a sock üß¶, the sock - in a boot ü•æ, the boot in a wardrobe locked with a key, the key to the wardrobe hid in his table&amp;rsquo;s drawer, and the key from the last had lost and by doing so arranged an unscheduled day-off for his employees. So is with the encryption on iOS devices:&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;device_encr_scheme.png&#34; alt=&#34;device_encr_scheme&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;File contents&amp;rsquo;s is encrypted with its key, which is stored in the metadata. File key is wrapped with a class key. The metadata, where this encrypted key is stored, is then encrypted by the file system key. All of it is finally protected by an alianz of the user&amp;rsquo;s passcode key and a hardware key (UID). Wow. Let&amp;rsquo;s dive a bit deeper, cause it all seems to be too messed up and confusing.&lt;/p&gt;&#xA;&lt;p&gt;User passcode if fed to RNG. It&amp;rsquo;s also to entangled with UID.&lt;/p&gt;&#xA;&lt;h2 id=&#34;class-keys&#34;&gt;Class keys&lt;/h2&gt;&#xA;&lt;p&gt;Class key represent protection classes. Each one except of &lt;strong&gt;NSFileProtectionNone&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;are protected with the alianz of hardware key and user passcode key:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Complete Protection (NSFileProtectionComplete)&lt;/strong&gt; Data is inaccessible until the user unlocks the device.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Protected Unless Open (NSFileProtectionCompleteUnlessOpen)&lt;/strong&gt;: Data is accessible after the user unlocks the device.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Protected Until First User Authentication (NSFileProtectionCompleteUntilFirstUserAuthentication)&lt;/strong&gt;: The file can be accessed as soon as the user unlocks the device for the first time after booting. It can be accessed even if the user subsequently locks the device and the class key is not removed from memory.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No Protection (NSFileProtectionNone)&lt;/strong&gt;: Protected with the UID only. The class key is stored in &amp;ldquo;Effaceable Storage&amp;rdquo;, which is a region of flash memory on the iOS device that allows the storage of small amounts of data. Used for remote wiping.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;About Secure Enclave:&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=7UNeUT_sRos&#34;&gt;https://www.youtube.com/watch?v=7UNeUT_sRos&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://support.apple.com/guide/security/welcome/web&#34;&gt;https://support.apple.com/guide/security/welcome/web&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;The main idea behind the scenes is that applications or even OS itself doesn&amp;rsquo;t know the keys. OS only sees Keychain, but the Security Enclave is separated. It&amp;rsquo;s asked to decrypt the information and it does just that returning the decrypted information.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;T2 vs T1&lt;/li&gt;&#xA;&lt;li&gt;Security Enclave - coprocessor with a Keymanager&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Devices which have the SE:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;iPhone 5s (or later)&lt;/li&gt;&#xA;&lt;li&gt;iPad Air (or later)&lt;/li&gt;&#xA;&lt;li&gt;Mac computers that contain the T1 chip or the Apple T2 Security Chip&lt;/li&gt;&#xA;&lt;li&gt;Apple TV 4th generation (or later)&lt;/li&gt;&#xA;&lt;li&gt;Apple Watch Series 1 (or later)&lt;/li&gt;&#xA;&lt;li&gt;HomePod&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Let&amp;rsquo;s observe this scheme from Apple website&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;SEP_scheme_Apple.png&#34; alt=&#34;SEP_scheme_Apple&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Secure Enclave and Application Processor (the main CPU) have separate boot processes and even separate starting code (BootROM) and separate OS. SE has its own light-weight OS (based on L4-family microkernel). And even update process is isolated. With each boot an ephemeral memory protection key is created.&lt;/p&gt;&#xA;&lt;h2 id=&#34;boot-process&#34;&gt;Boot process:&lt;/h2&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Boot ROM (&lt;strong&gt;R&lt;/strong&gt;ead &lt;strong&gt;O&lt;/strong&gt;nly &lt;strong&gt;M&lt;/strong&gt;emory) is executed like the Big Bang, out of nowhere. It&amp;rsquo;s called read-only because it can not be changes and therefore is hardware root of trust. It&amp;rsquo;s implicitly trusted. So they say, you know, if you can&amp;rsquo;t trust Boot ROM, whom can you trust then? Than would be a crazy world. Phew! üòÖ It&amp;rsquo;s such a relief that ROM can be ultimately trusted. It contains the Apple Root CA üîñ public key &amp;#x1f511;.&lt;/li&gt;&#xA;&lt;li&gt;Boot ROM creates a key&#xA;&lt;ol&gt;&#xA;&lt;li&gt;User&amp;rsquo;s key + device&amp;rsquo;s UID = ephemeral memory protection key&lt;/li&gt;&#xA;&lt;li&gt;Now, ephemeral memory protection key is used to protect Security Enclave&amp;rsquo;s memory.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 id=&#34;filevault&#34;&gt;FileVault&lt;/h2&gt;&#xA;&lt;h2 id=&#34;touchid&#34;&gt;TouchID&lt;/h2&gt;&#xA;&lt;p&gt;2012 - AuthenTec?&lt;/p&gt;&#xA;&lt;p&gt;Tied at the hardware level to A chip. &lt;code&gt;LAContext&lt;/code&gt; and User Presence/ACLs.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-swift&#34; data-lang=&#34;swift&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(touchIdIsSet){&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(checkcredentials()){&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;//authenticated&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;//error&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;http://highaltitudehacks.com/2013/07/25/ios-application-security-part-8-method-swizzling-using-cycript/&#34;&gt;http://highaltitudehacks.com/2013/07/25/ios-application-security-part-8-method-swizzling-using-cycript/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;questions&#34;&gt;Questions&lt;/h2&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;But I don&amp;rsquo;t enter the passcode at the very beginning. Where does SE get it from during the very first steps of its boot?&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;h2 id=&#34;low-level-security&#34;&gt;Low Level Security&lt;/h2&gt;&#xA;&lt;p&gt;&lt;code&gt;UID&lt;/code&gt; - key that is fused into Application processor. No one know it and can get from the device. Used to encrypt the contents.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;GUID&lt;/code&gt; -&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;UDID&lt;/code&gt; - device identifier. It can be retrived with iTunes.&lt;/p&gt;&#xA;&lt;p&gt;Home button - sapfire crystal for scratch resistance. Capacitive touch for detection.&lt;/p&gt;&#xA;&lt;h2 id=&#34;application-sandbox&#34;&gt;Application Sandbox&lt;/h2&gt;&#xA;&lt;p&gt;There are two users on iOS: &lt;code&gt;mobile&lt;/code&gt; and &lt;code&gt;root&lt;/code&gt;. When the device is not jailbroken, all applications and processes run by user are in &lt;code&gt;mobile&lt;/code&gt;&amp;rsquo;s context. Each application is sandboxed and certain policies are implemented (they are called &lt;em&gt;profiles&lt;/em&gt; in iOS). Hence, an application can&amp;rsquo;t access other apps&amp;rsquo; protected resources. This system is called &lt;em&gt;TrustedBSD Mandatory Access Control (MAC) Framework&lt;/em&gt;.  To access other apps&amp;rsquo; resources, entitlements are specified for each application and checked by &lt;code&gt;securityd&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 id=&#34;entitlements&#34;&gt;Entitlements&lt;/h2&gt;&#xA;&lt;p&gt;Consider some Russian &amp;#x1f1f7;&amp;#x1f1fa; &amp;#x1f469; woman willing to travel to Japan &amp;#x1f1ef;&amp;#x1f1f5;, EU &amp;#x1f1ea;&amp;#x1f1fa; and USA &amp;#x1f1fa;&amp;#x1f1f8;.  Since October Revolution in 1917 and WWI it&amp;rsquo;s no longer possible to do it so simply as that. For travelling one needs a visa &amp;#x1f3ab;, and usually each for each country one&amp;rsquo;s planning to attend.&lt;/p&gt;&#xA;&lt;p&gt;So, this Russian woman has two visas yet: Shengen and US, but has not aquired Japanese visa. On passport control &amp;#x1f6c2; (&lt;code&gt;securityd&lt;/code&gt;) these visas in her passport are checked and corresponding gates are opened if the visa is present. If not, the access to the country&amp;rsquo;s gate is restricted &amp;#x1f6ab;. Since she doesn&amp;rsquo;t have a Japanese visa, she is not &lt;em&gt;entitled&lt;/em&gt; to travel to Japan. Since she has EU and US visas, she can travel there freely. There are, of course, dozens of other people, who can have EU or US visa, so she&amp;rsquo;s not the only one entitled to get there. Basically, they are all in the same &lt;em&gt;entitlement group&lt;/em&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The same is here: each application has &amp;ldquo;passport&amp;rdquo; &amp;#x1f516; with entitlements (an array of strings), based on which an access is denied &amp;#x1f6ab; or allowed &amp;#x2705; by &amp;#x1f6c2; &lt;code&gt;securityd&lt;/code&gt; (passport control).&lt;/p&gt;&#xA;&lt;p&gt;All entitlements are added before or during signing the application, hence they cannot be changed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;em&gt;Apple is very well known for its value of security and the advanced security mechanisms. I personally found it hard sometimes to understand specific technical controls. This is why I am writing this little article. Smartphones are known to be more secure than desktops for they are also more MOBILE and tend to get lost a lot. That&amp;rsquo;s why MacBooks tend to get closer and closer to smartphones in terms of security.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>The Lord of the Apple: The Return of the iPhone</title>
      <link>https://bakerst221b.com/docs/blog/2021/08/lord-of-the-apple/</link>
      <pubDate>Sun, 25 Apr 2021 17:18:04 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/blog/2021/08/lord-of-the-apple/</guid>
      <description>&lt;p&gt;üìÜ &lt;code&gt;22/08/2021&lt;/code&gt; , &lt;em&gt;Sunday&lt;/em&gt;, ‚òÅÔ∏è&lt;/p&gt;&#xA;&lt;p&gt;üï∞ &lt;code&gt;11:21 AM&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;It was a cloudy Sunday morning. I was sleeping peacefully till 8:45 AM when my daughter started crawling all over me and my husband asking wether I am awake already&amp;hellip; . Well, now I am, darling, many thanks ü§¶üèª‚Äç‚ôÄÔ∏è! After having a delicious breakfast (eggplants with home-made tomato sauce, yummy üòã) and getting the kitchen back to the clean state (it&amp;rsquo;s very hard to keep it that way), I&amp;rsquo;ve decided to finally repair my little old fellow iPhone 7. Several weeks ago I went on vocation to Cyprus and broke the rare camera glass and the screen as well, because I somehow managed to drop the phone on the pavement 3 ‚ùóÔ∏ètimes! To be honest, these were not the first times when my iPhone met some surface harder than my palm, so it&amp;rsquo;s a miracle this had not happened before.&lt;/p&gt;</description>
    </item>
    <item>
      <title>How I Got Started With ARM</title>
      <link>https://bakerst221b.com/docs/blog/2021/03/how-i-got-started-with-arm/</link>
      <pubDate>Sun, 07 Mar 2021 11:42:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/blog/2021/03/how-i-got-started-with-arm/</guid>
      <description>&lt;p&gt;üìÜ &lt;code&gt;Friday, 12th of March, 202&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;‚è∞ &lt;code&gt;09:00&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;‚òÄÔ∏è &lt;em&gt;It was a very deceptively sunny morning, children laughing and squeaking merrily. When I closed my eyes I could almoust believe it was late spring or summer&amp;hellip;. And the soul was filling with joy and inspiration. But unfortunately the temperature was too low (-10 ‚ùÑÔ∏è ‚õÑÔ∏è  if you believe Yandex) and going for a outside-working-day was impossible üòî.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;I am finishing my cup of coffee ‚òïÔ∏è , my husband working in the adjacent room and my daughter playing with her new toys.&lt;/p&gt;</description>
    </item>
    <item>
      <title>APFS</title>
      <link>https://bakerst221b.com/docs/artefacts/fs/apfs/</link>
      <pubDate>Sun, 18 Oct 2020 22:35:40 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/fs/apfs/</guid>
      <description>&lt;h2 id=&#34;apfs&#34;&gt;APFS&lt;/h2&gt;&#xA;&lt;p&gt;APM and APFS seem to be unable to live together. APFS requires GUID. I have come to that conclusion when I tried formating the drive with a APM and then APFS with DiskUtility. The same goes for the MBR. APFS &lt;strong&gt;requires&lt;/strong&gt; GPT.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.apple.com/support/downloads/Apple-File-System-Reference.pdf&#34;&gt;https://developer.apple.com/support/downloads/Apple-File-System-Reference.pdf&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Advantages over HFS+&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Optimized for Flash/SSD Storage.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Full disk encryption is &lt;em&gt;natively&lt;/em&gt; supported.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Snapshot support.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Timestamps are to-the-nanosecond.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;9 quintillion files at most (18 zeroes).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Clones (aka copy-on-write). When the file is copied, it&amp;rsquo;s actually not duplicated. Instead, a new pointer is created. Once either of the files get changed, the actual copying process takes place.&lt;/p&gt;</description>
    </item>
    <item>
      <title>HFS and HFS&#43;</title>
      <link>https://bakerst221b.com/docs/artefacts/fs/hfs/</link>
      <pubDate>Sun, 18 Oct 2020 22:35:40 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/fs/hfs/</guid>
      <description>&lt;h2 id=&#34;hfs&#34;&gt;HFS&lt;/h2&gt;&#xA;&lt;h2 id=&#34;hfs-1&#34;&gt;HFS+&lt;/h2&gt;&#xA;&lt;p&gt;Since 1998, since macOS 8.1. Was replaced by APFS.&lt;/p&gt;&#xA;&lt;p&gt;Didn&amp;rsquo;t &lt;em&gt;natively&lt;/em&gt; support full disk encryption (FV2 was added later). Timestamps were only to-the-second. Support up to 4 billion files.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.apple.com/library/archive/technotes/tn/tn1150.html&#34;&gt;https://developer.apple.com/library/archive/technotes/tn/tn1150.html&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Supports large files&lt;/li&gt;&#xA;&lt;li&gt;Efficient disk space usage&lt;/li&gt;&#xA;&lt;li&gt;unicode for filenames&lt;/li&gt;&#xA;&lt;li&gt;name forks&lt;/li&gt;&#xA;&lt;li&gt;file compression&lt;/li&gt;&#xA;&lt;li&gt;journaling. Journaling is a mechanism in which changes to a disk are first committed to a journal file, which acts as a buffer to ensure that all disk update transactions are fully completed. &lt;a href=&#34;#1&#34;&gt;1&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;dynamic resizing, defragmentation&lt;/li&gt;&#xA;&lt;li&gt;not only for MacOS&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;&#xA;&lt;h3 id=&#34;1&#34;&gt;1&lt;/h3&gt;&#xA;&lt;p&gt;Sheward, Mike. Hands-on Incident Response and Digital Forensics (p. 138). BCS Learning &amp;amp; Development Limited. Kindle Edition.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üçé iOS Applications RE</title>
      <link>https://bakerst221b.com/docs/artefacts/files/executables/ios/reversing/</link>
      <pubDate>Fri, 09 Oct 2020 10:31:32 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/files/executables/ios/reversing/</guid>
      <description>&lt;p&gt;&lt;em&gt;During forensic analysis it&amp;rsquo;s not too rare to run into some suspicious application. In this article I&amp;rsquo;m going to learn to reverse engineer iOS applications.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;analysis-flow&#34;&gt;Analysis flow&lt;/h2&gt;&#xA;&lt;p&gt;First, we need to get IPA file from the device. There are different ways to do so (please, refer to &lt;a href=&#34;https://bakerst221b.com/docs/toolkit/mobile/ios-btfm-rtfm&#34;&gt;BTFM and RTFM&lt;/a&gt;). Here I&amp;rsquo;m going to use the easiest one:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ipainstaller -i &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ipainstaller -l | grep -i &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;package_partial_name&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; | grep Bundle&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;scp root@&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;device_ip&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;:/path/to/Bundle/ . &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Note that this method only works &lt;strong&gt;only if&lt;/strong&gt; the application was &lt;strong&gt;not&lt;/strong&gt; downloaded from AppStore, because the applications installed that way are encrypted and to get the code one needs to dump it decrpyted from memory (&lt;code&gt;frida-ios-dump.py&lt;/code&gt; with &lt;code&gt;frida-server&lt;/code&gt;) or decrypt it statically ().&lt;/p&gt;</description>
    </item>
    <item>
      <title>üçé iOS Applications RE</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/executables/ios/reversing/</link>
      <pubDate>Fri, 09 Oct 2020 10:31:32 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/executables/ios/reversing/</guid>
      <description>&lt;p&gt;&lt;em&gt;During forensic analysis it&amp;rsquo;s not too rare to run into some suspicious application. In this article I&amp;rsquo;m going to learn to reverse engineer iOS applications.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;analysis-flow&#34;&gt;Analysis flow&lt;/h2&gt;&#xA;&lt;p&gt;First, we need to get IPA file from the device. There are different ways to do so (please, refer to &lt;a href=&#34;https://bakerst221b.com/docs/toolkit/mobile/ios-btfm-rtfm&#34;&gt;BTFM and RTFM&lt;/a&gt;). Here I&amp;rsquo;m going to use the easiest one:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ipainstaller -i &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ipainstaller -l | grep -i &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;package_partial_name&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; | grep Bundle&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;scp root@&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;device_ip&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;:/path/to/Bundle/ . &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Note that this method only works &lt;strong&gt;only if&lt;/strong&gt; the application was &lt;strong&gt;not&lt;/strong&gt; downloaded from AppStore, because the applications installed that way are encrypted and to get the code one needs to dump it decrpyted from memory (&lt;code&gt;frida-ios-dump.py&lt;/code&gt; with &lt;code&gt;frida-server&lt;/code&gt;) or decrypt it statically ().&lt;/p&gt;</description>
    </item>
    <item>
      <title>iOS Reverse Engineering</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/ios-reversing/</link>
      <pubDate>Fri, 09 Oct 2020 10:31:32 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/ios-reversing/</guid>
      <description>&lt;p&gt;&lt;em&gt;During forensic analysis it&amp;rsquo;s not too rare to run into some suspicious application. In this article I&amp;rsquo;m going to learn to reverse engineer iOS applications.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;analysis-flow&#34;&gt;Analysis flow&lt;/h2&gt;&#xA;&lt;p&gt;First, we need to get IPA file from the device. There are different ways to do so (please, refer to &lt;a href=&#34;https://bakerst221b.com/docs/toolkit/mobile/ios-btfm-rtfm&#34;&gt;BTFM and RTFM&lt;/a&gt;). Here I&amp;rsquo;m going to use the easiest one:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ipainstaller -i &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;ipainstaller -l | grep -i lassen&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; | grep Bundle&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;scp root@&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;device_ip&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;:/path/to/Bundle/ . &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then open the Bundle folder on PC and look for &lt;code&gt;Info.plist&lt;/code&gt;. Let&amp;rsquo;s find any strings that start with &lt;code&gt;NS&lt;/code&gt; and end with &lt;code&gt;UsageDescription&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìö App Transport Security</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/ios-app-transport-security/</link>
      <pubDate>Tue, 06 Oct 2020 13:16:14 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/ios-app-transport-security/</guid>
      <description>&lt;p&gt;&lt;em&gt;In this article I&amp;rsquo;m trying to untangle a very confusing notion for some people (myself included) - App Transport Security. We will have several examples to work with and then try to construct our own setting according to our requirements.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-swift&#34; data-lang=&#34;swift&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NSAppTransportSecurity : Dictionary {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    NSAllowsArbitraryLoads : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    NSAllowsArbitraryLoadsForMedia : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    NSAllowsArbitraryLoadsInWebContent : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    NSAllowsLocalNetworking : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    NSExceptionDomains : Dictionary {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &amp;lt;domain&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;name&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;string&amp;gt; : Dictionary {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            NSIncludesSubdomains : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            NSExceptionAllowsInsecureHTTPLoads : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            NSExceptionMinimumTLSVersion : String&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            NSExceptionRequiresForwardSecrecy : Boolean   &lt;span style=&#34;color:#75715e&#34;&gt;// Default value is YES&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            NSRequiresCertificateTransparency : Boolean&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above code snippet from Apple &lt;a href=&#34;https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html&#34;&gt;docs&lt;/a&gt; shows the object that is responsible for loosening network security. This topic has been very confusing for me, but I&amp;rsquo;ve finally got myself untangled üéÑ &amp;#x1f408;  &amp;#x1f4a1; !&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìö Frida Crash Course</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/frida-crash-course/</link>
      <pubDate>Mon, 05 Oct 2020 10:31:08 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/frida-crash-course/</guid>
      <description>&lt;h2 id=&#34;intro&#34;&gt;Intro&lt;/h2&gt;&#xA;&lt;p&gt;Frida is cool&lt;/p&gt;&#xA;&lt;h2 id=&#34;templates&#34;&gt;Templates&lt;/h2&gt;&#xA;&lt;h3 id=&#34;empty&#34;&gt;Empty&lt;/h3&gt;&#xA;&lt;p&gt;If a method needs an argument of type &lt;code&gt;Context&lt;/code&gt;, &lt;code&gt;getApplicationContext()&lt;/code&gt; needs to be used. Otherwise, may skip it.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getApplicationContext&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ActivityThread&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Java&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;use&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;android.app.ActivityThread&amp;#34;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;currentApplication&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ActivityThread&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;currentApplication&lt;/span&gt;();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;currentApplication&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;getApplicationContext&lt;/span&gt;();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ret&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;bruteforcePIN&lt;/span&gt;() {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&lt;span style=&#34;color:#a6e22e&#34;&gt;Java&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;perform&lt;/span&gt;(() =&amp;gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// if the method requires Context type arg&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;context&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;getApplicationContext&lt;/span&gt;();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;&#x9;&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;// code here&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;e&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;// exceptions to handle, example:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;console&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;log&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;e&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#x9;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;reverse-bool&#34;&gt;Reverse Bool&lt;/h3&gt;&#xA;&lt;p&gt;If there is a function that returns a bool, and this bool value needs to be reversed:&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìö Decrypting iOS Applications</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/ios-decrypting-applications/</link>
      <pubDate>Thu, 01 Oct 2020 13:28:49 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/ios-decrypting-applications/</guid>
      <description>&lt;p&gt;&lt;em&gt;There are several tools available that perform decryption of iOS applications. iOS applications that are downloaded from AppStore are encrypted. AppStore simply won&amp;rsquo;t allow to upload an app without proper signature and encryption. To get .ipa from the device for further analysis one needs a tool. There are several tools available now (October, 2020). I&amp;rsquo;ve prepared a simple overview of the differences and how they work.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;ve taken a single application (in my case it was Bear) and decrypted it using several different tools. Frida-is-dumo and CrackerXI+ had the same output (md5 matches), clucth had a difference in several bytes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üß∞ Mac Setup Script</title>
      <link>https://bakerst221b.com/docs/tools/mac-setup-script/</link>
      <pubDate>Wed, 30 Sep 2020 18:33:56 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/tools/mac-setup-script/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;üóí TODO: Create a repo for this script!&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# oh my zsh bash themes&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sh -c &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# sh -c &amp;#34;$(fetch -o - https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# sh -c &amp;#34;$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# install pyenv&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install readline xz openssl zlib&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install pyenv&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install pyenv-virtualenv&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# configure pyenv for zsh&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;export PYENV_ROOT=&amp;#34;$HOME/.pyenv&amp;#34;&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; ~/.zshrc&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;export PATH=&amp;#34;$PYENV_ROOT/bin:$PATH&amp;#34;&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; ~/.zshrc&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo -e &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;if command -v pyenv 1&amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then\n  eval &amp;#34;$(pyenv init -)&amp;#34;\nfi&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; ~/.zshrc&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv install 3.8.5&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv install 2.7.18&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv global 3.8.5&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv virtualenv 2.7.18 python2 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv virtualenv 3.8.5 python3&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# radare2&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git clone https://github.com/radare/radare2.git&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd radare2&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./sys/install.sh&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;mobile-pentest&#34;&gt;Mobile Pentest&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Mobile tools&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv activate python2&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install git+https://github.com/iSECPartners/Introspy-Analyzer.git&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git clone https://github.com/MobSF/Mobile-Security-Framework-MobSF.git&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd Mobile-Security-Framework-MobSF&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./setup.sh&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv activate python3&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd Mobile-Security-Framework-MobSF&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./setup.sh&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv activate python3&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install frida&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install frida-tools&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install objection&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install npm&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;npm install -g passionfruit&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;npm install -g itms-services&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pyenv activate python2&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install drozer&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# bug fix&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# cd /Users/[User_name]/.pyenv/versions/2.7.18/envs/python2/lib/python2.7/site-packages/pydiesel/reflection/utils/class_loader.py&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# change elif relative_to.find(&amp;#34;.py&amp;#34;) &amp;gt;= 0 or relative_to.find(&amp;#34;.pyc&amp;#34;) &amp;gt;= 0:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# to elif (relative_to.find(&amp;#34;.py&amp;#34;) &amp;gt;= 0 or relative_to.find(&amp;#34;.pyc&amp;#34;) &amp;gt;= 0) and not &amp;#34;.pyenv&amp;#34; in relative_to:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ios&#34;&gt;iOS&lt;/h3&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# for idevice system info&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install libimobiledevice&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install ideviceinstaller&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;introspy&#34;&gt;Introspy&lt;/h4&gt;&#xA;&lt;p&gt;With iOS device connected. Two args: IP and password needed for the script.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Alloc8</title>
      <link>https://bakerst221b.com/docs/attacks/binary/exploits/alloc8/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/binary/exploits/alloc8/</guid>
      <description>&lt;p&gt;So, there are some prerequisites that one needs to have in order to get this exploit. These are what are BootROM, NOR, &lt;code&gt;malloc()&lt;/code&gt;, &lt;code&gt;NULL&lt;/code&gt; and heap.&lt;/p&gt;&#xA;&lt;p&gt;About BootROM you can read here. Briefly speaking, it&amp;rsquo;s a &lt;strong&gt;R&lt;/strong&gt;ead &lt;strong&gt;O&lt;/strong&gt;nly &lt;strong&gt;M&lt;/strong&gt;emory (thus ROM, not to be confused with RAM which stands for &lt;strong&gt;R&lt;/strong&gt;andomly &lt;strong&gt;A&lt;/strong&gt;ccessed &lt;strong&gt;M&lt;/strong&gt;emory, i.e. RAM and refers to the chip that&amp;rsquo;s being freed of any charge when the power is off). ROM only means that this part of the device cannot be in any way modified once it was produced: neither by the user, not by the manufacturer himself. Mobile devices use ROM to store the first step of CPU launch.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Calling ü§ô Conventions in x86</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-calling-conventions/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-calling-conventions/</guid>
      <description>&lt;p&gt;&lt;em&gt;In this article I&amp;rsquo;m giving an overview of different calling conventions with examples.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;intro&#34;&gt;Intro&lt;/h2&gt;&#xA;&lt;p&gt;Consider the following code snippet:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;mysteriousFunction&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; a, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; b)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; c;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mysteriousFunction&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// then the above function is called &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Let&amp;rsquo;s see the assembly code for each calling convention&lt;/p&gt;&#xA;&lt;h2 id=&#34;cdecl&#34;&gt;CDECL&lt;/h2&gt;&#xA;&lt;p&gt;The output in assemble would be this:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-assembly&#34; data-lang=&#34;assembly&#34;&gt;_mysteriousFunction:&#xA;push ebp&#xA;mov ebp, esp&#xA;mov eax, [ebp + 8]&#xA;mov edx, [ebp + 12]&#xA;add eax, edx&#xA;pop ebp&#xA;ret&#xA;and&#xA;&#xA;;main function&#xA;push 4 ; the second argument is pushed first&#xA;push 2 ; the first argument is pushed second&#xA;call _mysteriousFunction&#xA;add esp, 8&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As is clearly seen from the above snippet, the arguments to the function are passed in reverse order by means of &lt;code&gt;PUSH&lt;/code&gt; instruction (placed on stack). Observe the &lt;code&gt;_mysteriousFunction&lt;/code&gt;&amp;rsquo;s code: values added to &lt;code&gt;eax&lt;/code&gt;, but nothing seems to be returning, just &lt;code&gt;ret&lt;/code&gt;. That&amp;rsquo;s because this calling convention passes return values in &lt;code&gt;eax&lt;/code&gt; register by default.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Checkm8</title>
      <link>https://bakerst221b.com/docs/attacks/binary/exploits/checkm8/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/binary/exploits/checkm8/</guid>
      <description>&lt;details&gt;&#xA;    &lt;summary&gt;Expand&amp;hellip;&lt;/summary&gt;&#xA;    &lt;a href=&#34;https://belkasoft.com/checkm8_glossary&#34;&gt;https://belkasoft.com/checkm8_glossary&lt;/a&gt;&#xA;&lt;a href=&#34;https://belkasoft.com/checkm8-troubleshooting&#34;&gt;https://belkasoft.com/checkm8-troubleshooting&lt;/a&gt;&#xA;&lt;a href=&#34;https://belkasoft.com/checkm8&#34;&gt;https://belkasoft.com/checkm8&lt;/a&gt;&#xA;&lt;/details&gt;</description>
    </item>
    <item>
      <title>Flags</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-flags/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-flags/</guid>
      <description>&lt;h2 id=&#34;cf&#34;&gt;CF&lt;/h2&gt;&#xA;&lt;p&gt;Its full name is &lt;em&gt;carry flag&lt;/em&gt;. Its main purpose is to tell that the resulting number after some operations is too much to bear for the registry size. For example, the maximum size of a number is 32 bit, but if we add 0xFFFF&lt;/p&gt;&#xA;&lt;h2 id=&#34;zf&#34;&gt;ZF&lt;/h2&gt;&#xA;&lt;h2 id=&#34;of&#34;&gt;OF&lt;/h2&gt;</description>
    </item>
    <item>
      <title>Operations</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-operations/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-operations/</guid>
      <description>&lt;p&gt;In this article I&amp;rsquo;m describing all assembly operations that I&amp;rsquo;ve encountered myseld and also wasn&amp;rsquo;t lazy anough to put down an explanation about here. However, I won&amp;rsquo;t be paying much attention to some operation that I consider straightforward, like &lt;code&gt;ADD&lt;/code&gt;. I&amp;rsquo;m going to put a flag for each operation indicating corresponding arch: &lt;code&gt;arm&lt;/code&gt; or &lt;code&gt;x86&lt;/code&gt; (just learning ARM myself for iOS analysis).&lt;/p&gt;&#xA;&lt;p&gt;Most of instruction have the following anatomy: &lt;code&gt;instruction &amp;lt;destination operand&amp;gt;, &amp;lt;source operand&amp;gt;&lt;/code&gt;. Some operations look like this: &lt;code&gt;instruction &amp;lt;source operand&amp;gt;&lt;/code&gt; when &lt;code&gt;&amp;lt;destination operand&amp;gt;&lt;/code&gt; is always the same register (default). An example: &lt;code&gt;MUL&lt;/code&gt;. When &lt;code&gt;MUL&lt;/code&gt;ing, you always multiply &lt;code&gt;eax&lt;/code&gt; on some value.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Registers</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-registers/</link>
      <pubDate>Sun, 27 Sep 2020 16:31:05 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-registers/</guid>
      <description>&lt;h2 id=&#34;eax&#34;&gt;EAX&lt;/h2&gt;&#xA;&lt;h2 id=&#34;eip&#34;&gt;EIP&lt;/h2&gt;&#xA;&lt;h2 id=&#34;ebp&#34;&gt;EBP&lt;/h2&gt;&#xA;&lt;h2 id=&#34;rsiesi&#34;&gt;RSI/ESI&lt;/h2&gt;&#xA;&lt;p&gt;&lt;strong&gt;S&lt;/strong&gt;ource &lt;strong&gt;I&lt;/strong&gt;ndex.&lt;/p&gt;&#xA;&lt;p&gt;RSI - 64 bit, ESI - 32.&lt;/p&gt;&#xA;&lt;h2 id=&#34;rdiedi&#34;&gt;RDI/EDI&lt;/h2&gt;&#xA;&lt;p&gt;&lt;strong&gt;D&lt;/strong&gt;estination &lt;strong&gt;I&lt;/strong&gt;ndex.&lt;/p&gt;&#xA;&lt;p&gt;RDI - 64 bit, EDI - 32.&lt;/p&gt;&#xA;&lt;p&gt;For ARM Registers here - &lt;a href=&#34;https://azeria-labs.com/arm-data-types-and-registers-part-2/&#34;&gt;https://azeria-labs.com/arm-data-types-and-registers-part-2/&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Assembly Cheatsheet</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-cheatsheet/</link>
      <pubDate>Thu, 24 Sep 2020 11:43:54 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-cheatsheet/</guid>
      <description>&lt;p&gt;Lorem markdownum aequalis strigis. Saetigeri iubeas, vultu huic alvum nondum&#xA;de obside ut laniavit arbor palmis, cum quin. Rupes vetat videndo, armigerae&#xA;crimen habet Priamum nec.&lt;/p&gt;</description>
    </item>
    <item>
      <title>ARM Assembly</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-arm/</link>
      <pubDate>Thu, 24 Sep 2020 11:43:23 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-arm/</guid>
      <description>&lt;p&gt;&lt;em&gt;In this article I&amp;rsquo;m giving a quick dive-in into assembly. It&amp;rsquo;s very simple and very difficult at the same time. It takes time and patience to get friendly  with it. And once you do, there will be ARM emerging, which scares the hell out of you again. But it takes less time, once you&amp;rsquo;re familiar with its &amp;ldquo;big brother&amp;rdquo;.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;analogy&#34;&gt;Analogy&lt;/h2&gt;&#xA;&lt;p&gt;Sometimes when I look at assembly code I remember back in the &amp;lsquo;olden days&amp;rsquo; when I worked as office manager. I didn&amp;rsquo;t love my job and used to describe it to a small circle of close friends as &amp;ldquo;moving papers from one place to another&amp;rdquo;. Of course, there was much more to it than just that, but it felt that way. When I left this job and found the one as a C# programmer, I thought, I&amp;rsquo;ll never be doing that again. Surprisingly, I was right&amp;hellip; When I left my job as a C# programmer, I thought I&amp;rsquo;d never have anything to do with HTML again. Here, I was wrong&amp;hellip;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Assembly Intro</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-intro/</link>
      <pubDate>Thu, 24 Sep 2020 11:43:23 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/basics/assebly/assembly-intro/</guid>
      <description>&lt;p&gt;&lt;em&gt;In this article I&amp;rsquo;m giving a quick dive-in into assembly. It&amp;rsquo;s very simple and very difficult at the same time. It takes time and patience to get friendly  with it. And once you do, there will be ARM emerging, which scares the hell out of you again. But it takes less time, once you&amp;rsquo;re familiar with its &amp;ldquo;big brother&amp;rdquo;.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;analogy&#34;&gt;Analogy&lt;/h2&gt;&#xA;&lt;p&gt;Sometimes when I look at assembly code I remember back in the &amp;lsquo;olden days&amp;rsquo; when I worked as office manager. I didn&amp;rsquo;t love my job and used to describe it to a small circle of close friends as &amp;ldquo;moving papers from one place to another&amp;rdquo;. Of course, there was much more to it than just that, but it felt that way. When I left this job and found the one as a C# programmer, I thought, I&amp;rsquo;ll never be doing that again. Surprisingly, I was right&amp;hellip; When I left my job as a C# programmer, I thought I&amp;rsquo;d never have anything to do with HTML again. Here, I was wrong&amp;hellip;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìò macOS BTFM</title>
      <link>https://bakerst221b.com/docs/tools/field-manuals/mac-btfm/</link>
      <pubDate>Wed, 23 Sep 2020 10:26:29 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/tools/field-manuals/mac-btfm/</guid>
      <description>&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python FSEParser_V3.3.py -s -t folder /.fseventsd -o /Users/sentinel/Desktop/FSEvents_Out&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;</description>
    </item>
    <item>
      <title>üß∞ Mobile Toolkit</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/mobile-toolkit/</link>
      <pubDate>Wed, 23 Sep 2020 10:26:29 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/mobile-toolkit/</guid>
      <description>&lt;h2 id=&#34;debuggers&#34;&gt;Debuggers&lt;/h2&gt;&#xA;&lt;h3 id=&#34;gdb&#34;&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#gdb&#34;&gt;gdb&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h3 id=&#34;radare2&#34;&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#radare2&#34;&gt;radare2&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h3 id=&#34;other&#34;&gt;Other&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#ida-pro&#34;&gt;IDA Pro&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;[Hopper Disassembler](/docs/toolkit/general/reverse-toolkit/#hopper disassembler)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;static-code-analysis&#34;&gt;Static code analysis&lt;/h2&gt;&#xA;&lt;h3 id=&#34;ida-pro&#34;&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#ida-pro&#34;&gt;IDA Pro&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h3 id=&#34;hopper-disassembler&#34;&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#hopper-disassembler&#34;&gt;Hopper Disassembler&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h3 id=&#34;radare2-1&#34;&gt;&lt;a href=&#34;https://bakerst221b.com/docs/toolkit/general/reverse-toolkit/#radare2&#34;&gt;radare2&lt;/a&gt;&lt;/h3&gt;&#xA;&lt;h2 id=&#34;utilities&#34;&gt;Utilities&lt;/h2&gt;&#xA;&lt;h2 id=&#34;activity-analysis&#34;&gt;Activity Analysis&lt;/h2&gt;&#xA;&lt;h2 id=&#34;jailbreakingrooting&#34;&gt;Jailbreaking/Rooting&lt;/h2&gt;&#xA;&lt;h3 id=&#34;something&#34;&gt;Something&lt;/h3&gt;&#xA;&lt;p&gt;Desciption&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Host platforms&lt;/strong&gt;: &amp;#x1f308;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Target platforms&lt;/strong&gt;:  &amp;#x1f308;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Install&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Common commands&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Keywords&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Analogues&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Possible issues:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;multitools&#34;&gt;Multitools&lt;/h2&gt;&#xA;&lt;h3 id=&#34;passionfruit&#34;&gt;Passionfruit&lt;/h3&gt;&#xA;&lt;p&gt;&lt;strong&gt;Host platforms&lt;/strong&gt;: &amp;#x1f308;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Target platforms&lt;/strong&gt;:  &amp;#x1f308;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Install&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;brew install npm&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# install node js - https://nodejs.org/en/download/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# reopen terminal&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;npm install -g passionfruit    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;passionfruit&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Common commands&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;passionfruit&lt;/code&gt; to launch&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Keywords&lt;/strong&gt;: multitool, logs&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìò üìï BTFM and RTFM iOS</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/ios-btfm-rtfm/</link>
      <pubDate>Fri, 18 Sep 2020 15:30:57 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/ios-btfm-rtfm/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is a combination of BTFM and RTFM (Blue Team Field Manual and Red Team Field Manual) for iOS devices and applications. I used to keep two separate field manuals at first, but since there are just too many intersections, I&amp;rsquo;ve decided to combine them to make it easier to use. For Android RTFM and BTFM see &lt;a href=&#34;https://bakerst221b.com/docs/toolkit/manuals/android-btfm-rtfm&#34;&gt;here&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;cheatsheet&#34;&gt;Cheatsheet&lt;/h2&gt;&#xA;&lt;p&gt;&lt;em&gt;This cheasheet is to ease the flow of either penetration testing analysis or forensics investigation. Fill in the form below to speed up command line tools usage.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìö ApplePay, GooglePay, SamsungPay</title>
      <link>https://bakerst221b.com/docs/attacks/applications/mobile/mobile-payment-systems/</link>
      <pubDate>Thu, 10 Sep 2020 17:49:48 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/applications/mobile/mobile-payment-systems/</guid>
      <description>&lt;p&gt;Options: Google Wallet, Apple Pay, Samsumg Pay, Amazon Pay, Visa Checkout and PayPal. I think there are more,&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.linkedin.com/feed/update/urn:li:activity:6978379172934991873/&#34;&gt;https://www.linkedin.com/feed/update/urn:li:activity:6978379172934991873/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;samsung-pay&#34;&gt;Samsung Pay&lt;/h2&gt;&#xA;&lt;p&gt;I am planning to add SamsungPay as well (former LoopPay), when I get how it works and how it differs.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;–í–ù–ò–ú–ê–ù–ò–ï. Samsung Pay —Ä–∞–Ω–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é MST. –≠—Ç–æ –±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –±–µ–∑ &lt;a href=&#34;https://nastroyvse.ru/devices/raznoe/chto-delat-esli-net-nfc-modulya.html&#34;&gt;–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è NFC&lt;/a&gt;. –í–º–µ—Å—Ç–æ –¥–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –º–∞–≥–Ω–∏—Ç–Ω—ã–π, –ø–æ–∑–≤–æ–ª—è–≤—à–∏–π —Å–æ–≤–µ—Ä—à–∏—Ç—å –ø–æ–∫—É–ø–∫—É –¥–∞–∂–µ –Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö. –ù–æ –≤ –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª—è—Ö —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ –æ—Ç &lt;a href=&#34;https://nastroyvse.ru/opersys/android/mst-v-smartfone.html&#34;&gt;–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MST&lt;/a&gt; –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å, —Ç–∞–∫ –∫–∞–∫ —Å–µ–π—á–∞—Å 99% –º–∞–≥–∞–∑–∏–Ω–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ POS-—Ç–µ—Ä–º–∏–Ω–∞–ª—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–æ–ª–µ–µ –∑–∞—â–∏—â—ë–Ω–Ω–æ–≥–æ NFC [&lt;a href=&#34;https://nastroyvse.ru/programs/rating/platyozhnaya-sistema-android-pay-apple-pay-samsung-pay.html&#34;&gt;4&lt;/a&gt;].&lt;/p&gt;</description>
    </item>
    <item>
      <title>Mobile IPC</title>
      <link>https://bakerst221b.com/docs/attacks/binary/ipc/mobile-ipc/</link>
      <pubDate>Thu, 10 Sep 2020 17:49:48 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/attacks/binary/ipc/mobile-ipc/</guid>
      <description>&lt;h2 id=&#34;attacks&#34;&gt;Attacks&lt;/h2&gt;&#xA;&lt;h3 id=&#34;attacking-device&#34;&gt;Attacking device&lt;/h3&gt;&#xA;&lt;p&gt;For this attack there are several types of attacker:&#xA;‚Ä¢  MiM, i.e. a sniffer. This person is using the same network and intercepting traffic. What does that attacker need?&#xA;‚Ä¢  Mobile phone is stolen&#xA;‚Ä¢  Exploit&lt;/p&gt;&#xA;&lt;h3 id=&#34;attacking-applications&#34;&gt;Attacking applications&lt;/h3&gt;&#xA;&lt;p&gt;For this attack there are more types of attacker:&#xA;‚Ä¢  MiM - same network, certificate to install (if HTTP), setting attacker as proxy. If the person has enabled and forgotten to disable adb tcpip, you can connect from a trusted PC.&#xA;‚Ä¢  Stolen phone - PIN and DE circumvent, rooting (for acquiring some data), developer‚Äôs mode on&#xA;‚Ä¢  Malicious application - persuade the user to install an app. Preferably, gain maximum possible permissions. If rooted - big celebration.&#xA;‚Ä¢  Exploit - export written, physical access or access over network (depends on exploit), or malicious application installed (see above).&#xA;‚Ä¢  Malicious user - an application with bugs. For example, a user of e-banking has found a way to circumvent commission for transactions.&lt;/p&gt;</description>
    </item>
    <item>
      <title>iOS IPA</title>
      <link>https://bakerst221b.com/docs/artefacts/files/executables/ios/ios-ipa-structure/</link>
      <pubDate>Fri, 18 Sep 2020 11:54:26 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/files/executables/ios/ios-ipa-structure/</guid>
      <description>&lt;p&gt;When installed on the device, &lt;code&gt;*.ipa&lt;/code&gt; is unzipped into a corresponding folder. That&amp;rsquo;s the contents:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;Payload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Payload/Application.app&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;iTunesArtwork&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;iTunesMetadata.plist&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WatchKitSupport/WK&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The &lt;code&gt;*.ipa&lt;/code&gt;&amp;rsquo;s Payload is made of:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;MyApp&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Application&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Info.plist&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Launch images&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;MainWindow.nib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Settings.bundle&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Custom resource files&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Project folder &lt;code&gt;language.lproj&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;Base.lproj&lt;/code&gt; - for storyboards&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;en.lproj&lt;/code&gt; - for English strings&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;de.proj&lt;/code&gt; - for German strings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;To &lt;a href=&#34;https://medium.com/@lucideus/understanding-the-structure-of-an-ios-application-a3144f1140d4&#34;&gt;read&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;Info.plist&lt;/code&gt; contains configuration information for the application, such as its bundle ID, version number, and display name.&lt;/p&gt;</description>
    </item>
    <item>
      <title>iOS IPA</title>
      <link>https://bakerst221b.com/docs/ttp/malware/analyse/executables/ios/ios-ipa-structure/</link>
      <pubDate>Fri, 18 Sep 2020 11:54:26 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/ttp/malware/analyse/executables/ios/ios-ipa-structure/</guid>
      <description>&lt;p&gt;When installed on the device, &lt;code&gt;*.ipa&lt;/code&gt; is unzipped into a corresponding folder. That&amp;rsquo;s the contents:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;Payload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Payload/Application.app&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;iTunesArtwork&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;iTunesMetadata.plist&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WatchKitSupport/WK&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The &lt;code&gt;*.ipa&lt;/code&gt;&amp;rsquo;s Payload is made of:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;MyApp&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Application&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Info.plist&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Launch images&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;MainWindow.nib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Settings.bundle&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Custom resource files&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Project folder &lt;code&gt;language.lproj&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;Base.lproj&lt;/code&gt; - for storyboards&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;en.lproj&lt;/code&gt; - for English strings&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;de.proj&lt;/code&gt; - for German strings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;To &lt;a href=&#34;https://medium.com/@lucideus/understanding-the-structure-of-an-ios-application-a3144f1140d4&#34;&gt;read&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;Info.plist&lt;/code&gt; contains configuration information for the application, such as its bundle ID, version number, and display name.&lt;/p&gt;</description>
    </item>
    <item>
      <title>iOS Keychain</title>
      <link>https://bakerst221b.com/docs/artefacts/apple/keychain/</link>
      <pubDate>Fri, 02 Oct 2020 11:38:32 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/artefacts/apple/keychain/</guid>
      <description>&lt;p&gt;&lt;em&gt;In this article I&amp;rsquo;m trying to study how keychain works.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;metaphor&#34;&gt;Metaphor&lt;/h2&gt;&#xA;&lt;p&gt;There once lived a monkey &amp;#x1f412; George. He was a nice fellow, but his memory suck too much and caused him a lot of trouble. He also was very  absent-minded and has lost some of his secret keys. He met a bird &amp;#x1f414; Marvin and said: &lt;em&gt;&amp;ldquo;Marvin, my memory is no good, here are all my keys &amp;#x1f511;&amp;#x1f511;&amp;#x1f511;&amp;#x1f511; , I will just retain this small key-card &amp;#x1f3b4; which I will show you to prove it&amp;rsquo;s really me. Whenever I need a key, I&amp;rsquo;ll show you this card. You give me the key &amp;#x1f511; temporary and then take it back after I used it &amp;#x1f510; .&amp;rdquo;&lt;/em&gt;. Marvin was a very responsible guy and he agreed.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
