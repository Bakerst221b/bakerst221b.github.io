<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-ttp üîç">
      <a href="/docs/ttp">
        <span>TTP üîç</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db üè∫">
      <a href="/docs/artefacts">
        <span>Artefacts DB üè∫</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ‚öîÔ∏è">
      <a href="/docs/attacks">
        <span>Attacks DB ‚öîÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tools db üõ†Ô∏è">
      <a href="/docs/tools">
        <span>Tools DB üõ†Ô∏è</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/platforms/linux/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-ttp üîç">
      <a href="/docs/ttp">
        <span>TTP üîç</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db üè∫">
      <a href="/docs/artefacts">
        <span>Artefacts DB üè∫</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ‚öîÔ∏è">
      <a href="/docs/attacks">
        <span>Attacks DB ‚öîÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tools db üõ†Ô∏è">
      <a href="/docs/tools">
        <span>Tools DB üõ†Ô∏è</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    

    
    



 
 <h1 class="title">Linux</h1> 
 

    <h2><a href="http://localhost:1313/docs/ttp/sterilisation/"> üßº Media Sterilisation</a></h2> 
    <p> <p><em>Before copying evidence or making a disk image, one needs to sterilise the target media to ensure that data on that disk before this operation would not meddle with the evidence data. Several rounds of writing <code>0</code>s are usually enough.</em></p></p>

    <h2><a href="http://localhost:1313/docs/todo/old/defences/linux/"> üêß Linux Evidence Collection</a></h2> 
    <p> <h2 id="file-systems">File Systems</h2>
<p>EXT 2,3,4, ReiserFS, XFS, JFS, Btrfs.</p>
<p><strong>Logical Backup</strong> -  doesn&rsquo;t copy all, doesn&rsquo;t copy slack, free space and deleted files. <strong>Imaging</strong> - bit-by-bit copy. Should not be used on a live system!</p>
<h2 id="live-acquisition">Live Acquisition</h2>
<p><a href="https://github.com/Dead-Simple-Scripts/AutoLLR">https://github.com/Dead-Simple-Scripts/AutoLLR</a>
Automatically collection live info. Quite a heavy footprint. But if we are not collecting RAM, not the biggest issue.</p>
<h2 id="references">References</h2>
<p><a href="https://www.sans.org/presentations/long-live-linux-forensics/">https://www.sans.org/presentations/long-live-linux-forensics/</a>
<a href="https://www.sans.org/blog/getting-started-with-linux-memory-forensics/">https://www.sans.org/blog/getting-started-with-linux-memory-forensics/</a>
<a href="https://www.sans.org/blog/digital-forensics-ps3-linux-file-system-analysis-and-network-forensics/">https://www.sans.org/blog/digital-forensics-ps3-linux-file-system-analysis-and-network-forensics/</a>
<a href="https://www.sans.org/blog/bring-me-my-pipe/">https://www.sans.org/blog/bring-me-my-pipe/</a></p></p>

    <h2><a href="http://localhost:1313/docs/attacks/ids-ips/"> Host-based IDP/IPS</a></h2> 
    <p> <p>Host-based IDS look for local system configurations and behaviour, while network-based IDS look for network connections and looks for anomalies and common signatures.</p>
<p>IDS and IPS as firewall&rsquo;s filters. There are Control Plane (looks after the OS and routing table) and the Forwarding Plane (makes decisions on routing and discarding). If something happens to the Control Plane, the device will still forward the traffic (really???).</p>
<p>By default IDS only <strong>listens üëÇ</strong> the traffic. It&rsquo;s usually connected to the span port on a switch. Looks for anomalies and sends alerts. Won&rsquo;t take any actions by default, but can be configured in such a way. If the IDS is down, nothing is changed for the rest of the network, it&rsquo;s still operating.</p>
<p>IPS takes actions on its own. It is not connected to the span port, but rather is a gateway. Before it inspects and allows a packet through, nothing can move forward. So, if IPS is down, everyone is down (unless there is some load balancing enabled or may be some policy for such cases). Positioned right after the router, edge device or a firewall.</p></p>

    <h2><a href="http://localhost:1313/docs/artefacts/fs/extx/"> ExtX</a></h2> 
    <p> <h2 id="2">2</h2>
<p>No journaling</p>
<h2 id="3">3</h2>
<p>Same but + journaling</p>
<h2 id="4">4</h2>
<p>New FS</p></p>

    <h2><a href="http://localhost:1313/docs/artefacts/fs/fat/"> FAT</a></h2> 
    <p> <p>Any FAT partition has two main parts: system area and data area. System area contains FAT boot record (every file system has a boot record), 1st FAT and 2nd FAT. FAT12 and FAT16 also have Root directory in the system area. Data area consists of Root directory in case of FAT32 and file and subdirectory data in clusters.</p>
<h3 id="versions">Versions</h3>
<h4 id="fat12">FAT12</h4>
<p>For the cluster addressing there were 12 bits available, which is 2^12 clusters at most (4096 clusters).</p></p>

    <h2><a href="http://localhost:1313/docs/artefacts/fs/reiser/"> ReiserFS</a></h2> 
    <p> <p>Allows storing multiple files in a single sector. exclamation mark ‚ùóÔ∏èUnique to this FS!</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-calling-conventions/"> Calling ü§ô Conventions in x86</a></h2> 
    <p> <p><em>In this article I&rsquo;m giving an overview of different calling conventions with examples.</em></p>
<h2 id="intro">Intro</h2>
<p>Consider the following code snippet:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">mysteriousFunction</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b <span style="color:#f92672">+</span> c;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mysteriousFunction</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// then the above function is called 
</span></span></span></code></pre></div><p>Let&rsquo;s see the assembly code for each calling convention</p>
<h2 id="cdecl">CDECL</h2>
<p>The output in assemble would be this:</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">_mysteriousFunction:
push ebp
mov ebp, esp
mov eax, [ebp + 8]
mov edx, [ebp + 12]
add eax, edx
pop ebp
ret
and

;main function
push 4 ; the second argument is pushed first
push 2 ; the first argument is pushed second
call _mysteriousFunction
add esp, 8
</code></pre><p>As is clearly seen from the above snippet, the arguments to the function are passed in reverse order by means of <code>PUSH</code> instruction (placed on stack). Observe the <code>_mysteriousFunction</code>&rsquo;s code: values added to <code>eax</code>, but nothing seems to be returning, just <code>ret</code>. That&rsquo;s because this calling convention passes return values in <code>eax</code> register by default.</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-flags/"> Flags</a></h2> 
    <p> <h2 id="cf">CF</h2>
<p>Its full name is <em>carry flag</em>. Its main purpose is to tell that the resulting number after some operations is too much to bear for the registry size. For example, the maximum size of a number is 32 bit, but if we add 0xFFFF</p>
<h2 id="zf">ZF</h2>
<h2 id="of">OF</h2></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-operations/"> Operations</a></h2> 
    <p> <p>In this article I&rsquo;m describing all assembly operations that I&rsquo;ve encountered myseld and also wasn&rsquo;t lazy anough to put down an explanation about here. However, I won&rsquo;t be paying much attention to some operation that I consider straightforward, like <code>ADD</code>. I&rsquo;m going to put a flag for each operation indicating corresponding arch: <code>arm</code> or <code>x86</code> (just learning ARM myself for iOS analysis).</p>
<p>Most of instruction have the following anatomy: <code>instruction &lt;destination operand&gt;, &lt;source operand&gt;</code>. Some operations look like this: <code>instruction &lt;source operand&gt;</code> when <code>&lt;destination operand&gt;</code> is always the same register (default). An example: <code>MUL</code>. When <code>MUL</code>ing, you always multiply <code>eax</code> on some value.</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-registers/"> Registers</a></h2> 
    <p> <h2 id="eax">EAX</h2>
<h2 id="eip">EIP</h2>
<h2 id="ebp">EBP</h2>
<h2 id="rsiesi">RSI/ESI</h2>
<p><strong>S</strong>ource <strong>I</strong>ndex.</p>
<p>RSI - 64 bit, ESI - 32.</p>
<h2 id="rdiedi">RDI/EDI</h2>
<p><strong>D</strong>estination <strong>I</strong>ndex.</p>
<p>RDI - 64 bit, EDI - 32.</p>
<p>For ARM Registers here - <a href="https://azeria-labs.com/arm-data-types-and-registers-part-2/">https://azeria-labs.com/arm-data-types-and-registers-part-2/</a></p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-cheatsheet/"> Assembly Cheatsheet</a></h2> 
    <p> <p>Lorem markdownum aequalis strigis. Saetigeri iubeas, vultu huic alvum nondum
de obside ut laniavit arbor palmis, cum quin. Rupes vetat videndo, armigerae
crimen habet Priamum nec.</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-arm/"> ARM Assembly</a></h2> 
    <p> <p><em>In this article I&rsquo;m giving a quick dive-in into assembly. It&rsquo;s very simple and very difficult at the same time. It takes time and patience to get friendly  with it. And once you do, there will be ARM emerging, which scares the hell out of you again. But it takes less time, once you&rsquo;re familiar with its &ldquo;big brother&rdquo;.</em></p>
<h2 id="analogy">Analogy</h2>
<p>Sometimes when I look at assembly code I remember back in the &lsquo;olden days&rsquo; when I worked as office manager. I didn&rsquo;t love my job and used to describe it to a small circle of close friends as &ldquo;moving papers from one place to another&rdquo;. Of course, there was much more to it than just that, but it felt that way. When I left this job and found the one as a C# programmer, I thought, I&rsquo;ll never be doing that again. Surprisingly, I was right&hellip; When I left my job as a C# programmer, I thought I&rsquo;d never have anything to do with HTML again. Here, I was wrong&hellip;.</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/assebly/assembly-intro/"> Assembly Intro</a></h2> 
    <p> <p><em>In this article I&rsquo;m giving a quick dive-in into assembly. It&rsquo;s very simple and very difficult at the same time. It takes time and patience to get friendly  with it. And once you do, there will be ARM emerging, which scares the hell out of you again. But it takes less time, once you&rsquo;re familiar with its &ldquo;big brother&rdquo;.</em></p>
<h2 id="analogy">Analogy</h2>
<p>Sometimes when I look at assembly code I remember back in the &lsquo;olden days&rsquo; when I worked as office manager. I didn&rsquo;t love my job and used to describe it to a small circle of close friends as &ldquo;moving papers from one place to another&rdquo;. Of course, there was much more to it than just that, but it felt that way. When I left this job and found the one as a C# programmer, I thought, I&rsquo;ll never be doing that again. Surprisingly, I was right&hellip; When I left my job as a C# programmer, I thought I&rsquo;d never have anything to do with HTML again. Here, I was wrong&hellip;.</p></p>

    <h2><a href="http://localhost:1313/docs/tools/field-manuals/unix-btfm/"> üìò Linux BTFM</a></h2> 
    <p> <h2 id="variables">Variables</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># no spaces when assigning</span>
</span></span><span style="display:flex;"><span>$0 <span style="color:#75715e"># the first arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># array</span>
</span></span><span style="display:flex;"><span>array<span style="color:#f92672">=(</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span> 5<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span>array[0]<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span>array[*]<span style="color:#e6db74">}</span> <span style="color:#75715e"># all items delimited by IFS</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span>array[@]<span style="color:#e6db74">}</span> <span style="color:#75715e"># all items </span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${</span>!array[@]<span style="color:#e6db74">}</span> <span style="color:#75715e"># all indexes</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${#</span>array[@]<span style="color:#e6db74">}</span> <span style="color:#75715e"># number of items</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">${#</span>array[0]<span style="color:#e6db74">}</span> <span style="color:#75715e"># length of item 0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ARRAY<span style="color:#f92672">=(</span><span style="color:#66d9ef">$(</span>ls *.txt<span style="color:#66d9ef">)</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>COUNT<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> FILE in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ARRAY[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>	echo -n $FILE
</span></span><span style="display:flex;"><span>	echo -n <span style="color:#e6db74">&#34;[</span><span style="color:#e6db74">${</span>ARRAY[$COUNT]<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -w <span style="color:#e6db74">&#34;</span>$FILE<span style="color:#e6db74">&#34;</span><span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>		echo -e <span style="color:#e6db74">&#34;\t YES&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		echo -e <span style="color:#e6db74">&#34;\t NO&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h2 id="functions">Functions</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> functionname	<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	local name<span style="color:#f92672">=</span>$1
</span></span><span style="display:flex;"><span>	commands
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> functioname2 <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> commands		
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="conditions">Conditions</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># if/elif</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# -ne 1<span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;Exactly 1 arg needed&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># case</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">case</span> $var in
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#34;</span>$cond1<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>   commands
</span></span><span style="display:flex;"><span>   ;;
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#34;</span>$cond2<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>   commands
</span></span><span style="display:flex;"><span>   ;;
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#34;</span>$cond3<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>   commands
</span></span><span style="display:flex;"><span>   ;; 
</span></span><span style="display:flex;"><span>   *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>   commands
</span></span><span style="display:flex;"><span>   ;;
</span></span><span style="display:flex;"><span> *<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span> 	 commands
</span></span><span style="display:flex;"><span> 	 ;;
</span></span></code></pre></div><h2 id="loops">Loops</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># reading a file line by line</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read line
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> 
</span></span><span style="display:flex;"><span>  commands
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span> &lt; <span style="color:#e6db74">$&#34;Filename&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># or</span>
</span></span><span style="display:flex;"><span>cat <span style="color:#e6db74">$&#34;Filename&#34;</span> |
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> read line
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> 
</span></span><span style="display:flex;"><span>  commands
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span><span style="color:#f92672">((</span>i<span style="color:#f92672">=</span>0; i -lt 10; i++<span style="color:#f92672">))</span>; 
</span></span></code></pre></div><h2 id="examples">Examples</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> $# -gt <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> $1 in
</span></span><span style="display:flex;"><span>    -f|--file<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      FILE<span style="color:#f92672">=</span>$2
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ! <span style="color:#f92672">[</span> -f $FILE <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;This is not a valid file&#34;</span>
</span></span><span style="display:flex;"><span>      exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;Words in the file </span><span style="color:#66d9ef">$(</span>cat $FILE | wc -w<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>     -h|--help<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;specifiy a file&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts a:b:cd param; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> $param in 
</span></span><span style="display:flex;"><span>    a<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>     echo $OPTARG <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>     ;;
</span></span><span style="display:flex;"><span>    b<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>     echo $OPTARG <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>     ;;
</span></span><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>opts<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>getopt -o -a::b:cd --long file::,name;,help -- <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>eval set -- <span style="color:#e6db74">&#34;</span>$opts<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><h2 id="fuc">FUC</h2>
<p>(Frequently Used Commands)</p></p>

    <h2><a href="http://localhost:1313/docs/tools/field-manuals/sift-btfm/"> üìò SIFT BTFM</a></h2> 
    <p> <p><a href="https://sansorg.egnyte.com/dl/rcC7AFiUr0/?">Here</a> is the official cheatsheet from SANS. I&rsquo;ve copied it here for convenience. I will comment some of them after I try each command in the list.</p>
<h2 id="shadow-timeline-creation">Shadow Timeline Creation</h2>
<p><strong>Step 1 ‚Äì Attach Local or Remote System Drive</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ewfmount system-name.E01 /mnt/ewf
</span></span></code></pre></div><p><strong>Step 2 ‚Äì Mount VSS Volume</strong></p>
<p>VSS - Windows NT Volume Shadow Snapshot.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /mnt/ewf
</span></span><span style="display:flex;"><span>vshadowmount ewf1 /mnt/vss
</span></span></code></pre></div><p><strong>Step 3 ‚Äì Run <code>fls</code> across <code>ewf1</code> mounted image</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /mnt/ewf
</span></span><span style="display:flex;"><span>fls ‚Äìr ‚Äìm C: ewf1 &gt;&gt; /cases/vss-
</span></span><span style="display:flex;"><span>bodyfile
</span></span></code></pre></div><p><strong>Step 4 ‚Äì Run fls Across All Snapshot Images</strong></p></p>

    <h2><a href="http://localhost:1313/docs/attacks/applications/mobile/mobile-toolkit/"> üß∞ Mobile Toolkit</a></h2> 
    <p> <h2 id="debuggers">Debuggers</h2>
<h3 id="gdb"><a href="/docs/toolkit/general/reverse-toolkit/#gdb">gdb</a></h3>
<h3 id="radare2"><a href="/docs/toolkit/general/reverse-toolkit/#radare2">radare2</a></h3>
<h3 id="other">Other</h3>
<ul>
<li><a href="/docs/toolkit/general/reverse-toolkit/#ida-pro">IDA Pro</a></li>
<li>[Hopper Disassembler](/docs/toolkit/general/reverse-toolkit/#hopper disassembler)</li>
</ul>
<h2 id="static-code-analysis">Static code analysis</h2>
<h3 id="ida-pro"><a href="/docs/toolkit/general/reverse-toolkit/#ida-pro">IDA Pro</a></h3>
<h3 id="hopper-disassembler"><a href="/docs/toolkit/general/reverse-toolkit/#hopper-disassembler">Hopper Disassembler</a></h3>
<h3 id="radare2-1"><a href="/docs/toolkit/general/reverse-toolkit/#radare2">radare2</a></h3>
<h2 id="utilities">Utilities</h2>
<h2 id="activity-analysis">Activity Analysis</h2>
<h2 id="jailbreakingrooting">Jailbreaking/Rooting</h2>
<h3 id="something">Something</h3>
<p>Desciption</p>
<p><strong>Host platforms</strong>: &#x1f308;</p>
<p><strong>Target platforms</strong>:  &#x1f308;</p>
<p><strong>Install</strong>:</p>
<p><strong>Common commands</strong>:</p>
<p><strong>Keywords</strong>:</p>
<p><strong>Analogues</strong>:</p>
<p><strong>Possible issues:</strong></p>
<h2 id="multitools">Multitools</h2>
<h3 id="passionfruit">Passionfruit</h3>
<p><strong>Host platforms</strong>: &#x1f308;</p>
<p><strong>Target platforms</strong>:  &#x1f308;</p>
<p><strong>Install</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>brew install npm
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install node js - https://nodejs.org/en/download/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># reopen terminal</span>
</span></span><span style="display:flex;"><span>npm install -g passionfruit    
</span></span><span style="display:flex;"><span>passionfruit
</span></span></code></pre></div><p><strong>Common commands</strong>:</p>
<p><code>passionfruit</code> to launch</p>
<p><strong>Keywords</strong>: multitool, logs</p></p>

    <h2><a href="http://localhost:1313/docs/todo/cases/forensic-cases/case2/"> Case 1. IP Theft Linux Investigation</a></h2> 
    <p> <blockquote>
<p>Nearly all IP (intellectual property) are recreated by a competitor. Investigate the development machine</p></blockquote>
<p>Potential data exfiltration.</p>
<ol>
<li><code>netstat -lpeanut</code> shows that there are two dhcp clients running, one using unusual port and user:</li>
</ol>
<p><img src="images/4.png" alt="img"></p>
<ol>
<li><code>ps aux | grep 40500</code> or <code>ps aux | grep dhclient</code> shows the running processes and sometimes commands used to run them. This suspicious client was run from <code>/tmp</code> folder:</li>
</ol>
<p><img src="images/5.png" alt="img5"></p>
<ol>
<li><code>ls -la /tmp/</code> to see the file that was launched. But nothing there. Seems that the file was deleted after being launched:</li>
</ol>
<p><img src="images/6.png" alt="img6"></p></p>

    <h2><a href="http://localhost:1313/docs/todo/cases/forensic-cases/case3/"> Case 3. Yet Another Linux Investigation</a></h2> 
    <p> <ol>
<li>Running <code>netstat</code>, see the weird python script with established connection to some remote host:</li>
</ol>
<p><img src="images/10.png" alt="mg10"></p>
<ol start="2">
<li>Grab the executable: <code>lsof -p 2082</code> and <code>ps aux  grep 2082</code>.</li>
</ol>
<p><img src="images/11.png" alt="img11"></p>
<ol start="3">
<li>Let&rsquo;s see the <code>/tmp/</code> folder for <code>backdoor</code> executable</li>
<li>Check <code>/proc/2082</code> and <code>ls</code></li>
</ol>
<p><img src="images/12.png" alt="img12"></p>
<ol start="5">
<li>Since the executable is a legitimate python, need to explore further. In <code>/proc/2082</code> run <code>sudo cat cmdline</code> shows the comand used to launch, <code>cat task/2082/children</code> shows children PID. <code>sudo cat status</code> shows  general information. <code>cat environ</code> shows &hellip; . <code>cat arp</code> shows MAC addresses of the machines connected:</li>
</ol>
<p><img src="todo/cases/forensic-cases/case3/images/1.png" alt="img1"></p></p>

    <h2><a href="http://localhost:1313/docs/todo/cases/forensic-cases/case4/"> Case 4. Compromised Apache Server</a></h2> 
    <p> <blockquote>
<p>Compromised Apache Web server with drupal application used for local team. There was some unusual activity noticed between 05/10 and 08/10/19.</p></blockquote>
<p>You need to preserve edidence and some commands override artifacts (like <code>find</code>). Disable access times</p>
<ul>
<li><code>sudo mount -o remount,noatime /dev/...</code> or:</li>
<li><code>mkdir /mnt/extdrv/rootvol</code></li>
<li><code>rootvol=/mnt/extdrv/rootvol</code></li>
<li><code>sudo mount --bind / $rootvol</code></li>
<li><code>sudo mount -o remount,ro $rootvol</code></li>
</ul>
<p>User activity: <code>/etc/passwd</code>. <code>sudo debugfs -R 'stat &lt;1835260&gt;' /dev/...</code>.</p>
<p><img src="todo/cases/forensic-cases/case4/images/2.png" alt="img2"></p>
<p>checking groups. <code>tail -n 4 /etc/group</code>, <code>grep -E 'mail' | php' /etc/group</code></p></p>

    <h2><a href="http://localhost:1313/docs/reference/linux/linux-overview/"> üìö Linux OS Primer</a></h2> 
    <p> <h2 id="main-directories">Main Directories</h2>
<p><code>bin</code> - for binary executables. Common commands are found here - <code>ps</code>, <code>ls</code>, <code>ping</code>, <code>grep</code>, <code>cp</code> etc. These are basic programs for proper OS operation.</p>
<p><code>sbin</code> - same but more about <strong>system maintainance</strong> like <code>lptables</code>, <code>reboot</code>, <code>fdisk</code>, <code>ifconfig</code> etc.</p>
<p><code>etc</code> - configurations for user accounts and programs.</p>
<p><code>var</code> - files that expected to grow and change contantly. Contains <code>/var/logs</code> for surprise-surprise&hellip; wait for it&hellip; logs. Wow! üòØ</p>
<p><code>tmp</code> - contains temprory files, which are deleted on system reboot.</p></p>





<style>
    body {
    color: #212121;
}

h2 {
    font-weight: bold;
    
}

 
 
 
.pagination {
    display: flex;
    list-style: none;
    border-radius: .25rem;
    margin: 20px 0;
    padding: 0;
    justify-content: center;
}

.page-link {
    position: relative;
    display: block;
    padding: .75rem 1rem;
    margin-left: -1px;
    line-height: 1.25;
    color: #2bbc8a;
    background-color: #fff;
}

.homepage .page-link,
.listing .page-link {
    background-color: #fff;
}

.page-item.disabled .page-link {
    color: #6c757d;
    pointer-events: none;
    cursor: auto;
    background-color: #fff;
    border-color: #dee2e6;
}

.page-item.active .page-link {
    z-index: 1;
    color: #fff;
    background-color: #2bbc8a;;
    border-color:#2bbc8a;
    border-radius: 30px;
}

</style>
<nav aria-label="page navigation">
    <ul class="pagination">
        
        

        

        
             
            <li class="page-item active"><a href="/platforms/linux/" class="page-link">1</a></li>
            
        
            
             
            <li class="page-item"><a href="/platforms/linux/page/2/" class="page-link">2</a></li>
            
        

        
        <li class="page-item"><a href="/platforms/linux/page/2/" rel="next" class="page-link">Next ‚Ä∫</a></li>
        

        
        
    </ul>
</nav>


    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/platforms/linux/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
