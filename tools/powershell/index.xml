<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>PowerShell on Analyst</title>
    <link>https://bakerst221b.com/tools/powershell/</link>
    <description>Recent content in PowerShell on Analyst</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 28 Jul 2022 15:14:39 +1000</lastBuildDate>
    <atom:link href="https://bakerst221b.com/tools/powershell/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CyberCorp2</title>
      <link>https://bakerst221b.com/docs/todo/cases/ctf-walkthrough/cybercorp2/</link>
      <pubDate>Wed, 12 Jan 2022 11:42:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/todo/cases/ctf-walkthrough/cybercorp2/</guid>
      <description>&lt;p&gt;‚õîÔ∏è  Spoiler alert!&lt;/p&gt;&#xA;&lt;h2 id=&#34;case-details&#34;&gt;Case Details&lt;/h2&gt;&#xA;&lt;p&gt;This is not an investigation like the previous one. This is threat hunting. So, we have only logs via Kibana available. To harden my knowledge with this technologies I&amp;rsquo;ve had a very quick overview on ElasticStack website and enrolled in &lt;a href=&#34;https://app.pluralsight.com/paths/skills/threat-hunting-with-the-elastic-stack&#34;&gt;this&lt;/a&gt; course. Basically, I will have to answer questing having a loads of logs and a query engine available.&lt;/p&gt;&#xA;&lt;h2 id=&#34;questions&#34;&gt;Questions&lt;/h2&gt;&#xA;&lt;h3 id=&#34;1-wmi-event-consumer-name&#34;&gt;1. WMI Event Consumer name?&lt;/h3&gt;&#xA;&lt;p&gt;‚úÖ &lt;em&gt;The Threat Hunting process usually starts with the analyst making a hypothesis about a possible compromise vector or techniques used by an attacker. In this scenario, your initial hypothesis is as follows: &amp;ldquo;The attacker used the WMI subscription mechanism to obtain persistence within the infrastructure&amp;rdquo;. Verify this hypothesis and find the name of the WMI Event Consumer used by the attacker to maintain his foothold.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CyberCorp1</title>
      <link>https://bakerst221b.com/docs/todo/cases/ctf-walkthrough/cybercorp1/</link>
      <pubDate>Sat, 08 Jan 2022 11:42:21 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/todo/cases/ctf-walkthrough/cybercorp1/</guid>
      <description>&lt;p&gt;‚õîÔ∏è  Spoiler alert!&lt;/p&gt;&#xA;&lt;h2 id=&#34;case-details&#34;&gt;Case Details&lt;/h2&gt;&#xA;&lt;p&gt;&lt;strong&gt;Artefacts in posession&lt;/strong&gt;: memory dump, OS event logs, registry files, Prefetch files, $MFT file, ShimCache, AmCache, network traffic dumps. I&amp;rsquo;ve decided to analyse each artefact, what can I get from it in this specific case and how. Then, I am going to outline my strategy in approaching this case.&lt;/p&gt;&#xA;&lt;p&gt;We are looking for indicators of compromise.  There are no details as to what is the group and what was its aim. But it‚Äôs known that there was abnormal traffic detected that has launched this IR process. So, at least, we must have some suspicious traffic, possibly open or terminated connections. These should have been launched by some process, so we are looking for malware. Also, since the attacker needed an account to get in, I will be looking for an account take over attempts and possibly, new account creation.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìï Windows RTFM</title>
      <link>https://bakerst221b.com/docs/tools/field-manuals/win-rtfm/</link>
      <pubDate>Thu, 28 Jul 2022 15:14:39 +1000</pubDate>
      <guid>https://bakerst221b.com/docs/tools/field-manuals/win-rtfm/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üìò Powershell BTFM</title>
      <link>https://bakerst221b.com/docs/tools/field-manuals/ps-btfm/</link>
      <pubDate>Wed, 23 Sep 2020 10:26:29 +0300</pubDate>
      <guid>https://bakerst221b.com/docs/tools/field-manuals/ps-btfm/</guid>
      <description>&lt;h2 id=&#34;settings&#34;&gt;Settings&lt;/h2&gt;&#xA;&lt;h3 id=&#34;association&#34;&gt;Association&lt;/h3&gt;&#xA;&lt;p&gt;It&amp;rsquo;s better to associate powershell scripts with notepad.exe that PowerShell for security reasons.&lt;/p&gt;&#xA;&lt;h3 id=&#34;execution-policy&#34;&gt;Execution Policy&lt;/h3&gt;&#xA;&lt;p&gt;&lt;strong&gt;Get Execution Policy&lt;/strong&gt;. Powershell execution policy is applied to scripts only. Here are the main policies used:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ExecutionPolicy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Restricted &lt;span style=&#34;color:#75715e&#34;&gt;# no scripts are allowed (default for desktop)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; RemoteSigned &lt;span style=&#34;color:#75715e&#34;&gt;# downloaded scripts should be signed (preferred, default for WinServer). For local scripts no signature is required.&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Unrestricted &lt;span style=&#34;color:#75715e&#34;&gt;# everything is allowed (dangerous)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; Undefined &lt;span style=&#34;color:#75715e&#34;&gt;# Restricted for Win and RemoteSigned for WinServer&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; AllSigned &lt;span style=&#34;color:#75715e&#34;&gt;# Signatures are required for local scripts also&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;gt; ByPass &lt;span style=&#34;color:#75715e&#34;&gt;# Nothing is blocked, no warnings and prompts&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Other policies, official doc [&lt;a href=&#34;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies&#34;&gt;2&lt;/a&gt;].&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
