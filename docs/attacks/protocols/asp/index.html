<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“š Session, Presentation, Application Layer - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/attacks/protocols/asp/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
    <a href="/docs/attacks/protocols/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ“š Network Protocols </a>
  </p>
</div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          



 
 <h1 class="title">ğŸ“š Session, Presentation, Application Layer</h1> 
 

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/auth/"> Authentication Protocols</a></h2> 
    <p> </p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/crypto/"> Crypto Protocols</a></h2> 
    <p> <p><em>This section encompasses all the protocols that aim to ensure confidentiality by encrypting the traffic.</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/video/"> Video and Audio</a></h2> 
    <p> <p>ğŸ› ï¸ <code>dshell</code> can be used to analyse a <code>pcap</code> file for the specific traffic types. Please refer to the Toolkit sections, Forensics Lab Setup for installation steps.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>decode -p rtp -i wlan0 <span style="color:#75715e"># see all auido and video traffic</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/rdp/"> RDP</a></h2> 
    <p> <p>RDP Bitmap Cache. Windows developed RDPâ€”small chunks of screenshots. The size of each is <code>64x64</code> bit. And also, there is 1 huge sprite with all of them.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>USERPROFILE<span style="color:#f92672">%</span>\AppData\Local\Microsoft\Terminal Server Client\Cache
</span></span></code></pre></div><ul>
<li>older - <code>.bmc</code></li>
<li>newer - <code>Cache####.bin</code> where # is a number starting from <code>0</code></li>
</ul>
<blockquote>
<p>In case you investigate a successful RDP login to a specific machine, note that only in the case of the RDP login the â€œWorkstation Nameâ€ field in the â€œNetwork Informationâ€ section does not refer to the source machine name instead it refers to the name of the machine that recorded the event log (Target machine). be careful because such wrong information may miss leading your incident investigations. For the example in the screenshot, the â€œpbeeslyâ€ account logged on the â€œSCARNTONâ€ hostname from the <code>172.18.39.2</code> source machine IP. If you want to find the source machine name you can use the Event IDs 4778 or 4779 recorded in the security events instead. <a href="https://www.linkedin.com/posts/mostafa-yahia-701b4b15a_in-case-you-investigate-a-successful-rdp-activity-7004505487912112130-W6Oo?utm_source=share&amp;utm_medium=member_desktop">https://www.linkedin.com/posts/mostafa-yahia-701b4b15a_in-case-you-investigate-a-successful-rdp-activity-7004505487912112130-W6Oo?utm_source=share&amp;utm_medium=member_desktop</a></p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/telnet/"> Telnet</a></h2> 
    <p> <p><strong>Ports</strong>: <code>23</code></p>
<h3 id="-rtfm">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># If the Telnet port is open, you might try to log in with a user. If the user doesn&#39;t have a password set up, you might even be able to log in without a password.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>telnet &lt;IP&gt; &lt;port&gt;
</span></span><span style="display:flex;"><span>root <span style="color:#75715e"># or any other username that you think is there</span>
</span></span><span style="display:flex;"><span>Password: <span style="color:#75715e"># leave blank</span>
</span></span></code></pre></div></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/ftp/"> FTP and sFTP</a></h2> 
    <p> <p><em>This is about &hellip; .</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/dhcp/"> ğŸ“š DHCP</a></h2> 
    <p> <p><strong>D</strong>ynamic <strong>H</strong>ost <strong>C</strong>onfiguration <strong>P</strong>rotocol. Listening on 67 port. Sending from 68.</p>
<h2 id="mechanism">Mechanism</h2>
<h3 id="dhcp-discover-broadcast-c--s">DHCP Discover (Broadcast) C-&gt; S</h3>
<p>[new PC] ğŸ§¸ <em>&ldquo;I need an IP, I am new here. Only have this stupid useless 169.254.X.X address. Where do I register? Guys! Who knows where the DHCP is?&rdquo;</em></p>
<p><code>DHCPDISCOVER</code> is broadcasted in the network. Every machine, even non-DHCP once, hear this message.</p>
<h3 id="dhcp-offer-broadcastunicat-s---c">DHCP Offer (Broadcast/Unicat) S -&gt; C</h3>
<p>[DHCP server] ğŸ¥¸ <em>&ldquo;I&rsquo;m DHCP. How can I help?&rdquo;</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/dns/"> ğŸ“š DNS</a></h2> 
    <p> <p><strong>D</strong>omain <strong>N</strong>ame <strong>S</strong>ystem. Translates IPs to domain names like <code>192.168.1.1</code> to <code>router.lan</code> and visa versa.</p>
<p>DNS querying can be either recursive or non-recursive.</p>
<p><strong>Recursive</strong>. ISP DNS server queries other DNS servers until it finds the answer. Once it&rsquo;s found, it&rsquo;s returned by the ISP DNS to the client.</p>
<p><strong>Non-recursive</strong>. ISP DNS is not involved? Response comes directly from the DNS server queried the last. So, who has asked initially, would be shown in the last DNS server&rsquo;s logs ğŸ“.</p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/irc/"> ğŸ“š IRC</a></h2> 
    <p> <p>IRC stands for <strong>I</strong>nternet <strong>R</strong>elay <strong>C</strong>hat. Used for instant messaging. Usually sits at port 6667. On Linux can be installed and run with <code>sudo invoke-rc.d inspircd</code>.</p></p>

    <h2><a href="https://bakerst221b.com/docs/attacks/protocols/asp/smb/"> ğŸ“š SMB</a></h2> 
    <p> <ol>
<li>Over TCP - 445 port</li>
<li>Over NetBIOS API
<ol>
<li>UDP - ports 137, 138</li>
<li>TCP - ports 137, 139</li>
<li>NBF (legacy)</li>
</ol>
</li>
</ol>
<p>Powershell command + win reg for SMB 1,2,3.</p>
<h3 id="-rtfm">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p 139,445 --script smb-enum-shares &lt;target&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>brew install samba
</span></span><span style="display:flex;"><span>smbclient -U username -W workgroup -c <span style="color:#e6db74">&#39;ls&#39;</span> //server/share
</span></span></code></pre></div></p>





        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/attacks/protocols/asp/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
