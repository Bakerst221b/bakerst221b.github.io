<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Config Abuse - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/attacks/persesc/"> ğŸ‘ˆğŸ¼ Back to </br> Persistence and Escalation Mechanisms </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#-file-system">ğŸ“‚ File System</a></li>
        <li><a href="#-registry">âš™ï¸ Registry</a></li>
        <li><a href="#policies">Policies</a></li>
      </ul>
    </li>
    <li><a href="#linux">Linux</a></li>
    <li><a href="#macos">macOS</a>
      <ul>
        <li><a href="#login-items">Login Items</a></li>
        <li><a href="#programming-persistence">Programming persistence</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Config Abuse</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 03.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>Some persistence and escalation techniques don&rsquo;t require an exploit but only a little tweaking of some config.</em></p>
<h2 id="windows">Windows</h2>
<h3 id="-file-system">ğŸ“‚ File System</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>%AppData%<span style="color:#ae81ff">\R</span>oaming<span style="color:#ae81ff">\M</span>icorsoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>tart Menu<span style="color:#ae81ff">\P</span>rograms<span style="color:#ae81ff">\S</span>tartup
</span></span></code></pre></div><h3 id="-registry">âš™ï¸ Registry</h3>
<p>The list of reg keys that could be abused for persistence and escalation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ğŸ”‘ C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\[</span>Username<span style="color:#f92672">]</span><span style="color:#ae81ff">\A</span>ppData<span style="color:#ae81ff">\R</span>oaming<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>tart Menu<span style="color:#ae81ff">\P</span>rograms<span style="color:#ae81ff">\S</span>tartup <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ C:<span style="color:#ae81ff">\P</span>rogramData<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\S</span>tart Menu<span style="color:#ae81ff">\P</span>rograms<span style="color:#ae81ff">\S</span>tartUp <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>un <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unOnce <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>un <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unOnce <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unOnceEx: reg add HKLM<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unOnceEx<span style="color:#ae81ff">\0</span>001<span style="color:#ae81ff">\D</span>epend /v <span style="color:#ae81ff">1</span> /d <span style="color:#e6db74">&#34;C:\temp\evil[.]dll&#34;</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\U</span>ser Shell Folders
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\S</span>hell Folders
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\S</span>hell Folders
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\U</span>ser Shell Folders
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unServicesOnce
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unServicesOnce
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unServices
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\R</span>unServices
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>olicies<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\R</span>un <span style="color:#f92672">(</span>when specified in the policy settings<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>olicies<span style="color:#ae81ff">\E</span>xplorer<span style="color:#ae81ff">\R</span>un <span style="color:#f92672">(</span>when specified in the policy settings<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\W</span>inlogon<span style="color:#ae81ff">\U</span>serinit <span style="color:#75715e"># Usually, only userinit.exe is referenced here. Winlogon.exe will launch all executables mentioned when the user logs on. In case we have C:\Windows\System32\userinit.exe,C:\Temp\userinit.exe here, userinit.exe will be run from the Temp folder as well.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\W</span>inlogon<span style="color:#ae81ff">\S</span>hellÂ 
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_CURRENT_USER<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\W</span>indowsÂ <span style="color:#75715e"># run when any user logs on.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># multistringÂ BootExecuteÂ value of the registry</span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKEY_LOCAL_MACHINE<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>ession ManagerÂ <span style="color:#75715e"># toÂ autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot. Adversaries can use the autostart mechanism provided by LSA authentication packages for persistence by placing a reference to a binary in the Windows Registry locationÂ HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Â with the key value ofÂ &#34;Authentication Packages&#34;=&lt;target binary&gt;. The binary will then be executed by the system when the authentication packages are loaded. Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys ofÂ HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\.Â The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed. </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>oftware<span style="color:#f92672">[</span><span style="color:#ae81ff">\W</span>ow6432Node<span style="color:#ae81ff">\]\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\W</span>inlogon<span style="color:#ae81ff">\Â </span>
</span></span><span style="display:flex;"><span>ğŸ”‘Â HKCU<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\W</span>inlogon<span style="color:#ae81ff">\Â </span><span style="color:#75715e"># are used to manage additional helper programs and functionalities that support Winlogon.</span>
</span></span><span style="display:flex;"><span>	ğŸ”‘ Winlogon<span style="color:#ae81ff">\N</span>otify points to notification package DLLs that handle Winlogon events.
</span></span><span style="display:flex;"><span>	ğŸ”‘ Winlogon<span style="color:#ae81ff">\U</span>serinit points to userinit.exe, the user initialisation program executed when a user logs on
</span></span><span style="display:flex;"><span>	ğŸ”‘ Winlogon<span style="color:#ae81ff">\S</span>hell points to explorer.exe, the system shell executed when a user logs on
</span></span><span style="display:flex;"><span>HKLM<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\L</span>sa<span style="color:#ae81ff">\S</span>ecurity Packages, HKLM<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\L</span>sa<span style="color:#ae81ff">\O</span>SConfig<span style="color:#ae81ff">\S</span>ecurity Packages load into LSA space, meaning having access to unencrypted password info. 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Boot execute. Not sure what that means https://www.tenable.com/plugins/nessus/70615. It could be [this](https://github.com/beahunt3r/Windows-Hunting/blob/master/Persistence/Registry%20Autoruns/Boot%20Execute):</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>erviceControlManagerExtension
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>ession Manager<span style="color:#ae81ff">\B</span>ootExecute
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>ession Manager<span style="color:#ae81ff">\E</span>xecute
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>ession Manager<span style="color:#ae81ff">\S</span>0InitialCommand
</span></span><span style="display:flex;"><span>ğŸ”‘ HKLM<span style="color:#ae81ff">\S</span>ystem<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\S</span>ession Manager<span style="color:#ae81ff">\S</span>etupExecute
</span></span></code></pre></div><h3 id="policies">Policies</h3>
<p>More about it <a href="https://www.tenforums.com/tutorials/87919-enable-data-persistence-microsoft-edge-application-guard.html#option1">here</a>. This could be used to allow some legit software.</p>
<p><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> (when specified in the policy settings)</p>
<ul>
<li><code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> (when specified in the policy settings)</li>
</ul>
<h2 id="linux">Linux</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/etc/systemd/system  
</span></span><span style="display:flex;"><span>/usr/lib/systemd/system 
</span></span><span style="display:flex;"><span>/etc/init*
</span></span></code></pre></div><h2 id="macos">macOS</h2>
<h3 id="login-items">Login Items</h3>
<p><code>System Preferences -&gt; Users &amp; Groups -&gt; Login Items</code>. Additional: SDF podcast.</p>
<p>How to determine if it&rsquo;s malicious? Well, the sure way is only to reverse engineer it, but it is time consuming. So, you need to narrow down the candidates first. There are a couple of indicators that are commonly seen in malware.</p>
<blockquote>
<p>Login items run within the userâ€™s desktop session, inheriting the userâ€™s permissions, and start automatically at user login. Due to this afforded persistence, Mac malware will commonly install itself as a login item. You can find examples of this technique in malware like Kitm, NetWire, and WindTail. Wardle, Patrick. The Art of Mac Malware (p. 24). No Starch Press. Kindle Edition.</p></blockquote>
<blockquote>
<p>â—ï¸ macOS doesnâ€™t readily show the full path to a persisted login item in its interface (unless you hover over the item for a few seconds)</p></blockquote>
<p>ğŸ‘» <code>backgroundtaskmanagementagent</code> is a daemon that is running in the background and thus also manages login items. The list of the items is stored in a file âš™ï¸  named <code>backgrounditems.btm</code>.</p>
<h3 id="programming-persistence">Programming persistence</h3>
<p>âš™ï¸  <code>LSSharedFileListCreate</code> (returns the reference to the list) -&gt; <code>LSSharedFileListInsertItemURL</code> (adds a new item, requires a full path to the item).</p>
<p>To view the APIs used run <code>nm WindTail/Final_Presentation.app/Contents/MacOS/usrnode</code>. The above two APIs in the list suggest the binary used this persistence mechanism.</p>
<p>ğŸ¥·ğŸ¼ (stealthy) <code>SMLoginItemSetEnabled</code> - the â€œModern Login Itemsâ€ blog post or Appleâ€™s documentation. This allows application-specific helper login items. They don&rsquo;t show up in the Preferences. Those items are stored in <code>LoginItems</code> subdirectory of an applicationâ€™s bundle.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
