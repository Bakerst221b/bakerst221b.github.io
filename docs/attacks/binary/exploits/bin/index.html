<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Binary Vulnerabilities And Exploits - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/attacks/binary/exploits/"> ğŸ‘ˆğŸ¼ Back to </br> âš™ï¸ Exploits </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#type-safety">Type Safety</a></li>
    <li><a href="#integer-overflow">Integer Overflow</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Binary Vulnerabilities And Exploits</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/reverse" rel="tag">reverse</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>In this article I will collect common binary vulnerability (expept for the bufferoverflow which has its own dedicated article) &hellip; .</em></p>
<h2 id="type-safety">Type Safety</h2>
<p>There are programming languages which are type safe and which are not. Ruby and Python are type-safe because there is only 1 type - dynamic. All operations are permitted, but no all are implemented. In case of analogous code, there still will be an error, but that does not lead to a vulnerability.</p>
<p>What does that mean really? Consider the code snippet below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">int</span>(<span style="color:#f92672">*</span>cmp)(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>,<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>p<span style="color:#f92672">=</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)malloc(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>)); <span style="color:#75715e">//allocate memory on heap and assign p to the this address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">*</span>p<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; <span style="color:#75715e">// overwrite the address with number 1, i.e. invalid address
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>cmp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>(<span style="color:#f92672">*</span>)(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>, <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>))p; <span style="color:#75715e">//cast pointer to function pointer and assign to cmp variable
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>cmp <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#34;hello&#34;</span>, <span style="color:#e6db74">&#34;bye&#34;</span>); <span style="color:#75715e">// error, since p doesn&#39;t point to a valid address
</span></span></span></code></pre></div><p>What languages are not type-safe, you might ask? Well, guess. A little hint: almost all serious binary vulnerabilities are C++/C concern and any other language that manipulates memory manually, for that matter.</p>
<h2 id="integer-overflow">Integer Overflow</h2>
<p>On its own its rather benign and useless, so, it&rsquo;s usually comes with something more naughty (over/undersize a buffer, index beyond bounds).</p>
<p>Consider the snippet below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">copy</span> (<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> buffer_arg, <span style="color:#66d9ef">int</span> len) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">char</span> buff_var[<span style="color:#ae81ff">800</span>];
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (len <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">sizeof</span>(buff_var)) ret <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">memcpy</span>(buff_var, buffer_arg, len);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span>;	
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Variable <code>int</code> is unsigned integer, which means that it can&rsquo;t be <code>-1</code>. However, if you try assigning <code>-1</code> to it, it will be turned into <code>255</code> (2s compliment). It&rsquo;s a different topic, how exactly numbers get their lovely little minus, out of scope of this article, but in scope of another (<a href="/docs/reverse/basics/positive-and-negative-numbers/">see</a>).</p>
<p>When a computer sees a signed integer compared to an unsigned, it will interpret <code>int</code> as <code>uint</code> instead and thus will turn it into a positive number. Believe me, it will find a way to look at it in a <em>positive</em> light (computers all but pessimists ğŸ˜‚). So, <code>-1</code> will magically turn into <code>255</code> like a pumpkin ğŸƒ into a carriage ğŸš”.</p>
<p><img src="images/signed-to-unsigned.png" alt="img"></p>
<p>You can try yourself <a href="https://onlinetoolz.net/unsigned-signed#base=10&amp;value=-1&amp;bits=8">here</a>.</p>
<p>Say, some program flow led to <code>int len=-1</code> somehow. And let&rsquo;s say that <code>sizeof(buff_var)</code> equals <code>800</code>. What will a computer see when executing <code>len &gt; sizeof(buff_var)</code>? Since <code>sizeof()</code> returns <code>uint</code>, it will see roughly the following: <code>â—ï¸uint len &gt; uint sizeof(buff_var)</code>, or <code>255 &gt; 800</code>. Since <code>255</code> is not greater that <code>800</code>, the code following the <code>if</code> statement will get executed.</p>
<p>Let&rsquo;s ee enother example. Let&rsquo;s say there is a woman with a ğŸ‘œ bag wants to put a lot of purely lady stuff inside: ğŸ—, ğŸ’·, ğŸ’„, ğŸ©¹, ğŸ“™, ğŸ–Œ, ğŸª“, so, 7 items.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>ushort items_to_stash;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> bag_size;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> <span style="color:#960050;background-color:#1e0010">ğŸ‘œ</span>[<span style="color:#ae81ff">7</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// a simple check that we have the required amount of arguments (irrelevant for this discussion)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (argc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>) <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bag_size <span style="color:#f92672">=</span> <span style="color:#a6e22e">atoi</span>(arg[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>items_to_stash <span style="color:#f92672">=</span> bag_size;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// this bag is limited to 7 items, it can&#39;t have more. Can it?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (items_to_stash <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">7</span>) { <span style="color:#75715e">// items_to_stash is ushort, i.e. it&#39;s unsigned and can be less than 0. However, bag_size (which was the original value, is int). So, we use it as an unsigned when comparing and then we will use the int (signed) version of it when performing the actual copy process.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Hey! This bag is not the one Hermione had!&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;That&#39;s the way, well done. Put the axe back :) Ladies don&#39;t carry them at leisure.&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">memcpy</span>(<span style="color:#960050;background-color:#1e0010">ğŸ‘œ</span>,[<span style="color:#960050;background-color:#1e0010">ğŸ—</span>,<span style="color:#960050;background-color:#1e0010">ğŸ’·</span>,<span style="color:#960050;background-color:#1e0010">ğŸ’„</span>,<span style="color:#960050;background-color:#1e0010">ğŸ©¹</span>,<span style="color:#960050;background-color:#1e0010">ğŸ“™</span>,<span style="color:#960050;background-color:#1e0010">ğŸ–Œ</span>,<span style="color:#960050;background-color:#1e0010">ğŸª“</span>],bag_size); <span style="color:#75715e">// here is the copying itself
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span></code></pre></div><p>With <code>atoi(arg[1])</code> we get the second argument passed to our program (which would be the bag&rsquo;s ğŸ‘œ capacity). This value is saved to <code>int bag_size</code> variable that can get less than <code>0</code>. Then, for some unknown and reason that eludes me totally, this gets copied into a <code>ushort</code> (unsigned) <code>items_to_stash</code> variable which is then used to perform comparisson. Since <code>7</code> is considered to be signed, <code>ushort items_to_stash</code> temporarily transforms into <code>short items_to_stash</code> (invisible to us, but still).</p>
<p>The same problem outlined above would happen here should <code>bag_size</code> get below <code>0</code> ğŸ¥¶ for some reason â„ï¸.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand &hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
