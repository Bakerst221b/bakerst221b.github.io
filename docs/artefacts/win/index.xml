<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ü™ü Windows Artefacts on Analyst</title>
    <link>http://localhost:1313/docs/artefacts/win/</link>
    <description>Recent content in ü™ü Windows Artefacts on Analyst</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 18 Jul 2023 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/docs/artefacts/win/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>üè∫ LSA</title>
      <link>http://localhost:1313/docs/artefacts/win/lsa/</link>
      <pubDate>Wed, 21 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/lsa/</guid>
      <description>&lt;p&gt;*This article centres around the crowned queen of the Windows kingdom: LSA (&lt;code&gt;lsass.exe&lt;/code&gt;), a darling among attackers for the sheer power it wields.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Windows Backups</title>
      <link>http://localhost:1313/docs/artefacts/win/backup/</link>
      <pubDate>Tue, 18 Jul 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/backup/</guid>
      <description>&lt;p&gt;&lt;em&gt;Shadow Copies are exactly those pieces of data that get saved on disk when the system restore option is enabled. Once triggered, these files restore the system to the previous state. It&amp;rsquo;s very useful when you are not an expert in PC and something weird is happening. However, not only ordinary people find this feature useful. Some bad guys might try to cover their tracks which can sometimes be undone with this feature.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üèûÔ∏è Thumbnails</title>
      <link>http://localhost:1313/docs/artefacts/win/thumbnails/</link>
      <pubDate>Tue, 11 Jul 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/thumbnails/</guid>
      <description>&lt;p&gt;*These are created when a user switches a folder to thumbnail mode or views pictures via a slide show. *&lt;/p&gt;</description>
    </item>
    <item>
      <title>üóëÔ∏è Recycle Bin</title>
      <link>http://localhost:1313/docs/artefacts/win/bin/</link>
      <pubDate>Tue, 11 Jul 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/bin/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>ü´±üèΩ‚Äçü´≤üèæ Shares</title>
      <link>http://localhost:1313/docs/artefacts/win/shares/</link>
      <pubDate>Mon, 26 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/shares/</guid>
      <description>&lt;p&gt;&lt;em&gt;Admins would get mad very quickly if they had to physically access every machine they needed to configure or patch. Admin shares are hidden folders to be accessed remotely, typically over SMB.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Accounts</title>
      <link>http://localhost:1313/docs/artefacts/win/accounts/</link>
      <pubDate>Wed, 21 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/accounts/</guid>
      <description>&lt;p&gt;&lt;em&gt;To carry out nearly any action on a system, one requires an account, which is typically safeguarded by passwords or other credentials. Hence, it is crucial to understand why attackers exhibit such a strong interest in acquiring them.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Cache</title>
      <link>http://localhost:1313/docs/artefacts/win/cache/</link>
      <pubDate>Wed, 21 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/cache/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ LNK files</title>
      <link>http://localhost:1313/docs/artefacts/win/lnk/</link>
      <pubDate>Wed, 21 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/lnk/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Credentials</title>
      <link>http://localhost:1313/docs/artefacts/win/credentials/</link>
      <pubDate>Fri, 09 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/credentials/</guid>
      <description>&lt;p&gt;&lt;em&gt;This article is about credentials, the keys to the realm.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ ADS</title>
      <link>http://localhost:1313/docs/artefacts/win/ads/</link>
      <pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/ads/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ CMD and Powershell</title>
      <link>http://localhost:1313/docs/artefacts/win/console/</link>
      <pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/console/</guid>
      <description>&lt;h2 id=&#34;cmd&#34;&gt;CMD&lt;/h2&gt;&#xA;&lt;p&gt;Batch script. Highly limited in functionality and caching all sorts of crap, including credentials.&lt;/p&gt;&#xA;&lt;h2 id=&#34;powershell&#34;&gt;PowerShell&lt;/h2&gt;&#xA;&lt;h3 id=&#34;anatomy&#34;&gt;Anatomy&lt;/h3&gt;&#xA;&lt;p&gt;Authentication cons:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Traffic is encrypted&lt;/li&gt;&#xA;&lt;li&gt;Kerberos is used for authentication&lt;/li&gt;&#xA;&lt;li&gt;Credentials are not cached on the remote system (not AS).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;PowerShell gives you the power of WMI, .NET and COM at once. It provides a unified interface to interact with data types such as the registry, file volumes, Active Directory etc.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;‚ùóÔ∏èThe output of most of the ps commands are not strings but objects that can be piped into other commands.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Crash Files</title>
      <link>http://localhost:1313/docs/artefacts/win/crash/</link>
      <pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/crash/</guid>
      <description>&lt;p&gt;&lt;em&gt;This is about &amp;hellip; .&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ DNS Cache</title>
      <link>http://localhost:1313/docs/artefacts/win/dnscache/</link>
      <pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/dnscache/</guid>
      <description>&lt;p&gt;There are several ways to retrieve this information manually.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;ipconfig /displaydns&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Win32_DnsCache&lt;/code&gt; from WMI repo (use Kansa to collect and stack this data)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h4 id=&#34;-btfm&#34;&gt;üìò BTFM&lt;/h4&gt;&#xA;&lt;p&gt;Stacking, purely manually (no grouping):&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Get-ChildItem -Filter &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*-DNSCache.csv&amp;#34;&lt;/span&gt; | ForEach-Object { Import-Csv $_.FullName } | Export-Csv -Path &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DNSCacheStack.csv&amp;#34;&lt;/span&gt; -NoTypeInformation&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Stacking, purely manual, with grouping (basically, the same results as with &lt;code&gt;Get-LogparserStack.ps1&lt;/code&gt; but the case is ignored):&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$csvFiles = Get-ChildItem -Path &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.\*DNSCache.csv&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$result = @()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; ($csvFile &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; $csvFiles) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    $data = Import-Csv -Path $csvFile.FullName&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    $result += $data&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$groupedData = $result | Group-Object -Property Name | Select-Object Count, Name, @{Name=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PC&amp;#34;&lt;/span&gt;; Expression={$_.Group.&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;PSComputerName&amp;#39;&lt;/span&gt;}} &lt;span style=&#34;color:#75715e&#34;&gt;# the column contains spaces but the script will see no spaces, so, it&amp;#39;s not a typo&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$groupedData | Export-Csv -Path &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;result2.csv&amp;#34;&lt;/span&gt; -NoTypeInformation&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Stacking, Kansa script:&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Windows Event Log</title>
      <link>http://localhost:1313/docs/artefacts/win/eventlog/</link>
      <pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/eventlog/</guid>
      <description>&lt;p&gt;&lt;em&gt;Event Logs in Windows provide valuable insights for defenders. They can be forwarded to a central machine to monitor organisational-level activities and detect malicious behaviour effectively.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Prefetch</title>
      <link>http://localhost:1313/docs/artefacts/win/prefetch/</link>
      <pubDate>Thu, 01 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/prefetch/</guid>
      <description>&lt;p&gt;&lt;em&gt;Every day, the computer loads some programs and a lot of additional crap that comes with it. Every day the same routine over and over again. Being a diligent and responsible guy, it wondered how to improve this process. So, it decides to save the most recently loaded programs and whatever dlls and stuff these programs need so that everything is ready the next time the program is run. Where is this data stored? In Prefetch.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ RAM</title>
      <link>http://localhost:1313/docs/artefacts/win/ram/</link>
      <pubDate>Thu, 01 Jun 2023 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/ram/</guid>
      <description>&lt;p&gt;*Memory is the best evidence, although the hardest to preserve. If you recall Frozen II, &amp;ldquo;Water has memory&amp;rdquo; - same story. Even if you delete all the evidence, memory silently remembers all that. But it&amp;rsquo;s so fragile&amp;hellip;&#xA;&lt;img src=&#34;images/boiler-leaking-water-scaled.jpg&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Active Directory</title>
      <link>http://localhost:1313/docs/artefacts/win/ad/</link>
      <pubDate>Thu, 28 Jul 2022 15:14:39 +1000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/ad/</guid>
      <description>&lt;p&gt;Moving accounts and auth policies to the server side. Azure Active Directory is when instead of having a physical server, you have a server in the cloud ‚õÖÔ∏è. Defines a set of rules to restrict users&amp;rsquo; access to resources. PCs that are part of AD usually don&amp;rsquo;t have full access to the systems.&lt;/p&gt;&#xA;&lt;p&gt;AD DS store contains db files and processes that manage directory information for users, services and applications. Consists of &lt;code&gt;Ntds.dit&lt;/code&gt; file, at &lt;code&gt;%SystemRoot%\&#x9;NTDS&lt;/code&gt; folder on all DC. Is only accessible thtough the DC&amp;rsquo;s processes and protocols.&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ WMI</title>
      <link>http://localhost:1313/docs/artefacts/win/wmi/</link>
      <pubDate>Thu, 28 Jul 2022 15:14:39 +1000</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/wmi/</guid>
      <description>&lt;p&gt;&lt;em&gt;In days of yore, there existed a humble batch, whence emerged the WMI, and it didst hold dominion o&amp;rsquo;er the realm of Windows contraptions for a considerable span until it was entwined with the might of PowerShell.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>üè∫ Windows Core Processes</title>
      <link>http://localhost:1313/docs/artefacts/win/core/</link>
      <pubDate>Mon, 28 Sep 2020 13:21:43 +0300</pubDate>
      <guid>http://localhost:1313/docs/artefacts/win/core/</guid>
      <description>&lt;p&gt;&lt;em&gt;There are two broad categories of Windows core processes. Processes that initialize system environment and those that initialize the user environment. Whatever is the category, you need to know them well in order to detect abnormal things.&lt;/em&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
