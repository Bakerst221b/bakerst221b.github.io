<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forensic Cases ğŸ’¼ - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/todo/cases/forensic-cases/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
    <a href="/docs/todo/cases/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ’¼ Sample Cases </a>
  </p>
</div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          



 
 <h1 class="title">Forensic Cases ğŸ’¼</h1> 
 

    <h2><a href="https://bakerst221b.com/docs/todo/cases/forensic-cases/case1/"> A Study in Black</a></h2> 
    <p> <p>Someone has violated corporate policy by watching porn using the corp PC.</p>
<p>Do you have the authority?</p>
<p>What are the expected results?</p>
<p><strong>Some prohibited internet traffic</strong>. Check network logs of an application layer firewall ğŸ”¥ or content filter (any gateway between the suspect and the network), filter them out. But the user was smart enough to use VPN. What&rsquo;s then? Application layer firewall only sees application traffic, it is not aware of TCPs, Shudipis and etc. Read <a href="/docs/articles/fundamentals/network/osi/overview">this</a> article about TCP/IP stack to understand better why application layer firewalls won&rsquo;t see anything other than what&rsquo;s on top.</p></p>

    <h2><a href="https://bakerst221b.com/docs/todo/cases/forensic-cases/case2/"> Case 1. IP Theft Linux Investigation</a></h2> 
    <p> <blockquote>
<p>Nearly all IP (intellectual property) are recreated by a competitor. Investigate the development machine</p></blockquote>
<p>Potential data exfiltration.</p>
<ol>
<li><code>netstat -lpeanut</code> shows that there are two dhcp clients running, one using unusual port and user:</li>
</ol>
<p><img src="images/4.png" alt="img"></p>
<ol>
<li><code>ps aux | grep 40500</code> or <code>ps aux | grep dhclient</code> shows the running processes and sometimes commands used to run them. This suspicious client was run from <code>/tmp</code> folder:</li>
</ol>
<p><img src="images/5.png" alt="img5"></p>
<ol>
<li><code>ls -la /tmp/</code> to see the file that was launched. But nothing there. Seems that the file was deleted after being launched:</li>
</ol>
<p><img src="images/6.png" alt="img6"></p></p>

    <h2><a href="https://bakerst221b.com/docs/todo/cases/forensic-cases/case3/"> Case 3. Yet Another Linux Investigation</a></h2> 
    <p> <ol>
<li>Running <code>netstat</code>, see the weird python script with established connection to some remote host:</li>
</ol>
<p><img src="images/10.png" alt="mg10"></p>
<ol start="2">
<li>Grab the executable: <code>lsof -p 2082</code> and <code>ps aux  grep 2082</code>.</li>
</ol>
<p><img src="images/11.png" alt="img11"></p>
<ol start="3">
<li>Let&rsquo;s see the <code>/tmp/</code> folder for <code>backdoor</code> executable</li>
<li>Check <code>/proc/2082</code> and <code>ls</code></li>
</ol>
<p><img src="images/12.png" alt="img12"></p>
<ol start="5">
<li>Since the executable is a legitimate python, need to explore further. In <code>/proc/2082</code> run <code>sudo cat cmdline</code> shows the comand used to launch, <code>cat task/2082/children</code> shows children PID. <code>sudo cat status</code> shows  general information. <code>cat environ</code> shows &hellip; . <code>cat arp</code> shows MAC addresses of the machines connected:</li>
</ol>
<p><img src="todo/cases/forensic-cases/case3/images/1.png" alt="img1"></p></p>

    <h2><a href="https://bakerst221b.com/docs/todo/cases/forensic-cases/case4/"> Case 4. Compromised Apache Server</a></h2> 
    <p> <blockquote>
<p>Compromised Apache Web server with drupal application used for local team. There was some unusual activity noticed between 05/10 and 08/10/19.</p></blockquote>
<p>You need to preserve edidence and some commands override artifacts (like <code>find</code>). Disable access times</p>
<ul>
<li><code>sudo mount -o remount,noatime /dev/...</code> or:</li>
<li><code>mkdir /mnt/extdrv/rootvol</code></li>
<li><code>rootvol=/mnt/extdrv/rootvol</code></li>
<li><code>sudo mount --bind / $rootvol</code></li>
<li><code>sudo mount -o remount,ro $rootvol</code></li>
</ul>
<p>User activity: <code>/etc/passwd</code>. <code>sudo debugfs -R 'stat &lt;1835260&gt;' /dev/...</code>.</p>
<p><img src="todo/cases/forensic-cases/case4/images/2.png" alt="img2"></p>
<p>checking groups. <code>tail -n 4 /etc/group</code>, <code>grep -E 'mail' | php' /etc/group</code></p></p>

    <h2><a href="https://bakerst221b.com/docs/todo/cases/forensic-cases/case5/"> Case 5. Kali Linux Data Exfiltration</a></h2> 
    <p> <blockquote>
<p>IP theft and Kali Linux is a suspect. Has the user exfiltrated pictures or documents?</p></blockquote>
<p>Can look for info in xdg directories:</p>
<ul>
<li><code>~/.cache</code> ($XDG_CACHE_HOME)</li>
<li><code>~/.local/share</code> ($XDG_DATA_HOME)</li>
<li><code>~/.config</code> ($XDG_CONFIG_HOME)</li>
</ul>
<p>Can look for info in non-xdg dirs:</p>
<ul>
<li><code>~/.&lt;application_name&gt;</code></li>
<li><code>~</code> (user home dir)</li>
</ul>
<p><code>cat .bash_history</code> and defaults in <code>./bashrc</code>. For Kali <code>~/.msf4/history</code> (doesn&rsquo;t log commands for the remote shell), <code>~/.nc_history</code> (created if <code>rlwrap </code> was used to run <code>nc</code>. Also <code>~/.viminfo</code>: cmd history, string search history, input-line history, contents of non-empty regs, marks for several files, file marks pointing to locs in files, last search/sub pattern for &rsquo;n&rsquo; or &lsquo;&amp;&rsquo;, buffer list, global vars. <code>~/.cache/sessions</code> - by xfce-session and only if sessions are saved: list of open progs that were saved from last session (when the user last logged out) for recent Kalis. Xfce-session-[hostname]:0 and <code>.bak</code> - prev version of it. Client - prog or windows that needs to be opened. At the end of the file the amount of progs that are to be run and last time this session was last saved (not opened by user ). XFWM - xfce window manager.</p></p>





        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/todo/cases/forensic-cases/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
