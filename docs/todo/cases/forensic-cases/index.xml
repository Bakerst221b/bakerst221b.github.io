<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Forensic Cases ðŸ’¼ on Analyst</title>
    <link>http://localhost:1313/docs/todo/cases/forensic-cases/</link>
    <description>Recent content in Forensic Cases ðŸ’¼ on Analyst</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 20 Sep 2020 11:04:28 +0300</lastBuildDate>
    <atom:link href="http://localhost:1313/docs/todo/cases/forensic-cases/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>A Study in Black</title>
      <link>http://localhost:1313/docs/todo/cases/forensic-cases/case1/</link>
      <pubDate>Sun, 20 Sep 2020 11:04:28 +0300</pubDate>
      <guid>http://localhost:1313/docs/todo/cases/forensic-cases/case1/</guid>
      <description>&lt;p&gt;Someone has violated corporate policy by watching porn using the corp PC.&lt;/p&gt;&#xA;&lt;p&gt;Do you have the authority?&lt;/p&gt;&#xA;&lt;p&gt;What are the expected results?&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Some prohibited internet traffic&lt;/strong&gt;. Check network logs of an application layer firewall ðŸ”¥ or content filter (any gateway between the suspect and the network), filter them out. But the user was smart enough to use VPN. What&amp;rsquo;s then? Application layer firewall only sees application traffic, it is not aware of TCPs, Shudipis and etc. Read &lt;a href=&#34;http://localhost:1313/docs/articles/fundamentals/network/osi/overview&#34;&gt;this&lt;/a&gt; article about TCP/IP stack to understand better why application layer firewalls won&amp;rsquo;t see anything other than what&amp;rsquo;s on top.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Case 1. IP Theft Linux Investigation</title>
      <link>http://localhost:1313/docs/todo/cases/forensic-cases/case2/</link>
      <pubDate>Sun, 20 Sep 2020 11:04:28 +0300</pubDate>
      <guid>http://localhost:1313/docs/todo/cases/forensic-cases/case2/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;Nearly all IP (intellectual property) are recreated by a competitor. Investigate the development machine&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;Potential data exfiltration.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;netstat -lpeanut&lt;/code&gt; shows that there are two dhcp clients running, one using unusual port and user:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/4.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;ps aux | grep 40500&lt;/code&gt; or &lt;code&gt;ps aux | grep dhclient&lt;/code&gt; shows the running processes and sometimes commands used to run them. This suspicious client was run from &lt;code&gt;/tmp&lt;/code&gt; folder:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/5.png&#34; alt=&#34;img5&#34;&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;ls -la /tmp/&lt;/code&gt; to see the file that was launched. But nothing there. Seems that the file was deleted after being launched:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/6.png&#34; alt=&#34;img6&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Case 3. Yet Another Linux Investigation</title>
      <link>http://localhost:1313/docs/todo/cases/forensic-cases/case3/</link>
      <pubDate>Sun, 20 Sep 2020 11:04:28 +0300</pubDate>
      <guid>http://localhost:1313/docs/todo/cases/forensic-cases/case3/</guid>
      <description>&lt;ol&gt;&#xA;&lt;li&gt;Running &lt;code&gt;netstat&lt;/code&gt;, see the weird python script with established connection to some remote host:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/10.png&#34; alt=&#34;mg10&#34;&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Grab the executable: &lt;code&gt;lsof -p 2082&lt;/code&gt; and &lt;code&gt;ps aux  grep 2082&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/11.png&#34; alt=&#34;img11&#34;&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Let&amp;rsquo;s see the &lt;code&gt;/tmp/&lt;/code&gt; folder for &lt;code&gt;backdoor&lt;/code&gt; executable&lt;/li&gt;&#xA;&lt;li&gt;Check &lt;code&gt;/proc/2082&lt;/code&gt; and &lt;code&gt;ls&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;images/12.png&#34; alt=&#34;img12&#34;&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Since the executable is a legitimate python, need to explore further. In &lt;code&gt;/proc/2082&lt;/code&gt; run &lt;code&gt;sudo cat cmdline&lt;/code&gt; shows the comand used to launch, &lt;code&gt;cat task/2082/children&lt;/code&gt; shows children PID. &lt;code&gt;sudo cat status&lt;/code&gt; shows  general information. &lt;code&gt;cat environ&lt;/code&gt; shows &amp;hellip; . &lt;code&gt;cat arp&lt;/code&gt; shows MAC addresses of the machines connected:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;todo/cases/forensic-cases/case3/images/1.png&#34; alt=&#34;img1&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Case 4. Compromised Apache Server</title>
      <link>http://localhost:1313/docs/todo/cases/forensic-cases/case4/</link>
      <pubDate>Sun, 20 Sep 2020 11:04:28 +0300</pubDate>
      <guid>http://localhost:1313/docs/todo/cases/forensic-cases/case4/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;Compromised Apache Web server with drupal application used for local team. There was some unusual activity noticed between 05/10 and 08/10/19.&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;You need to preserve edidence and some commands override artifacts (like &lt;code&gt;find&lt;/code&gt;). Disable access times&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;sudo mount -o remount,noatime /dev/...&lt;/code&gt; or:&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;mkdir /mnt/extdrv/rootvol&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;rootvol=/mnt/extdrv/rootvol&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sudo mount --bind / $rootvol&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sudo mount -o remount,ro $rootvol&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;User activity: &lt;code&gt;/etc/passwd&lt;/code&gt;. &lt;code&gt;sudo debugfs -R &#39;stat &amp;lt;1835260&amp;gt;&#39; /dev/...&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;todo/cases/forensic-cases/case4/images/2.png&#34; alt=&#34;img2&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;checking groups. &lt;code&gt;tail -n 4 /etc/group&lt;/code&gt;, &lt;code&gt;grep -E &#39;mail&#39; | php&#39; /etc/group&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Case 5. Kali Linux Data Exfiltration</title>
      <link>http://localhost:1313/docs/todo/cases/forensic-cases/case5/</link>
      <pubDate>Sun, 20 Sep 2020 11:04:28 +0300</pubDate>
      <guid>http://localhost:1313/docs/todo/cases/forensic-cases/case5/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;IP theft and Kali Linux is a suspect. Has the user exfiltrated pictures or documents?&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;Can look for info in xdg directories:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;~/.cache&lt;/code&gt; ($XDG_CACHE_HOME)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;~/.local/share&lt;/code&gt; ($XDG_DATA_HOME)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;~/.config&lt;/code&gt; ($XDG_CONFIG_HOME)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Can look for info in non-xdg dirs:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;~/.&amp;lt;application_name&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;~&lt;/code&gt; (user home dir)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;cat .bash_history&lt;/code&gt; and defaults in &lt;code&gt;./bashrc&lt;/code&gt;. For Kali &lt;code&gt;~/.msf4/history&lt;/code&gt; (doesn&amp;rsquo;t log commands for the remote shell), &lt;code&gt;~/.nc_history&lt;/code&gt; (created if &lt;code&gt;rlwrap &lt;/code&gt; was used to run &lt;code&gt;nc&lt;/code&gt;. Also &lt;code&gt;~/.viminfo&lt;/code&gt;: cmd history, string search history, input-line history, contents of non-empty regs, marks for several files, file marks pointing to locs in files, last search/sub pattern for &amp;rsquo;n&amp;rsquo; or &amp;lsquo;&amp;amp;&amp;rsquo;, buffer list, global vars. &lt;code&gt;~/.cache/sessions&lt;/code&gt; - by xfce-session and only if sessions are saved: list of open progs that were saved from last session (when the user last logged out) for recent Kalis. Xfce-session-[hostname]:0 and &lt;code&gt;.bak&lt;/code&gt; - prev version of it. Client - prog or windows that needs to be opened. At the end of the file the amount of progs that are to be run and last time this session was last saved (not opened by user ). XFWM - xfce window manager.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
