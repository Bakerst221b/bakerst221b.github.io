<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Block Ciphers - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/cryptography/symmetric/"> ğŸ‘ˆğŸ¼ Back to </br> Symmetric Algorithms </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#cbc">CBC</a></li>
    <li><a href="#ecb">ECB</a></li>
    <li><a href="#cbc-1">CBC</a></li>
    <li><a href="#ctr">CTR</a>
      <ul>
        <li><a href="#cracking">Cracking</a></li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Block Ciphers</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/crypto" rel="tag">crypto</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 06.10.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>This is the next generation. 128-bit blocks, 128,192, 256 keys. It takes too much time to brute force. However, there are some situations when this could be cracked. And not only ECB but CBC as well.</p>
<p>One block of plaintext results in a 2-block cypher (random string + cypher text) for some modes. That&rsquo;s why different modes exist.</p>
<ul>
<li>Stream
<ul>
<li>synchronised</li>
<li>unsynchronised</li>
</ul>
</li>
<li>Block
<ul>
<li>CTR</li>
<li></li>
</ul>
</li>
</ul>
<p>Encryption steps:</p>
<ul>
<li><input disabled="" type="checkbox"> Choose some random string of length N (call it a ğŸŠ)</li>
<li><input disabled="" type="checkbox"> Do something with the string to get a key ğŸ— from ğŸŠ</li>
<li><input disabled="" type="checkbox"> XOR your message ğŸ† with a key ğŸ—</li>
<li><input disabled="" type="checkbox"> Cypher text ğŸ« = ğŸŠ, ğŸ† XOR ğŸ—</li>
</ul>
<p>Decryption steps:</p>
<ul>
<li><input disabled="" type="checkbox"> c2 XOR Fk(c1)</li>
</ul>
<h2 id="cbc">CBC</h2>
<p>Let&rsquo;s start with an example. Let&rsquo;s say we want to encrypt the message: <code>explore</code>. If it&rsquo;s ASCII, it&rsquo;s 7 bytes long. Let&rsquo;s translate this into char: <code>65 78 70 6C 6F 72 65</code>. Since the message needs to be padded to become 8 bytes long and we only have one character to add, we add <code>01</code> (see PKCS#5 padding).</p>
<table>
  <thead>
      <tr>
          <th>65</th>
          <th>78</th>
          <th>70</th>
          <th>6C</th>
          <th>6F</th>
          <th>72</th>
          <th>65</th>
          <th>01</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>Now, we pick an array of random numbers of the same length to make an <code>IV</code> (initialisation vector):</p>
<table>
  <thead>
      <tr>
          <th>89</th>
          <th>03</th>
          <th>42</th>
          <th>12</th>
          <th>01</th>
          <th>00</th>
          <th>98</th>
          <th>54</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>We first XOR IV with the message to get the following result:</p>
<table>
  <thead>
      <tr>
          <th>EC</th>
          <th>7B</th>
          <th>32</th>
          <th>7E</th>
          <th>6E</th>
          <th>72</th>
          <th>FD</th>
          <th>55</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>Then we encrypt this newly acquired array with AES (a series of shifting, meddling and xoring).</p>
<p>In the end, we have the following output:</p>
<table>
  <thead>
      <tr>
          <th>89</th>
          <th>03</th>
          <th>42</th>
          <th>12</th>
          <th>01</th>
          <th>00</th>
          <th>98</th>
          <th>54</th>
          <th>EC</th>
          <th>7B</th>
          <th>32</th>
          <th>7E</th>
          <th>6E</th>
          <th>72</th>
          <th>FD</th>
          <th>55</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>The first 8 bytes are the IV, and the last 8 are the encrypted message. How do we find out what the plaintext has access to the IV and be able to modify it and observe the server response?</p>
<h2 id="ecb">ECB</h2>
<p>Why is ECB considered insecure? To answer that we could go back to one-time pad and answer the question &ldquo;why is one-time pad insecure when the same key is used more than once?&rdquo; We already know why it&rsquo;s not good. If you need to refresh it, go to the article about one-time pad to find more information.</p>
<p>Here is a picture I found online that shows how ECB works.</p>
<p>Let&rsquo;s keep things simple. If the encryption algorithm ğŸ” is basically adding number three 3 to each block, then the resulting blocks would retain the same difference as they had in the plaintext. All of the blocks become <code>+3</code>.</p>
<p><img src="images/ecb.png" alt="img"></p>
<h2 id="cbc-1">CBC</h2>
<p><img src="images/cbc.png" alt="img"></p>
<h2 id="ctr">CTR</h2>
<p>Encryption steps:</p>
<ul>
<li><input disabled="" type="checkbox"> </li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>some_function(ctr):
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> ctr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>number_of_blocks <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>ctr <span style="color:#f92672">=</span> random(length<span style="color:#f92672">=</span>key_length)
</span></span><span style="display:flex;"><span>message <span style="color:#f92672">=</span> [number_of_blocks]
</span></span><span style="display:flex;"><span>cypher_text <span style="color:#f92672">=</span> ctr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,number_of_blocks):
</span></span><span style="display:flex;"><span>	cypher_text <span style="color:#f92672">+=</span> message[i] <span style="color:#f92672">^</span> ctr
</span></span><span style="display:flex;"><span>	some_function(ctr <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>Decryption steps:</p>
<h3 id="cracking">Cracking</h3>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
