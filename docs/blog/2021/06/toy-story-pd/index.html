<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>To Carry Out MockInv&#39;estigation. Part 1 - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-ttp üîç">
      <a href="/docs/ttp">
        <span>TTP üîç</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db üè∫">
      <a href="/docs/artefacts">
        <span>Artefacts DB üè∫</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ‚öîÔ∏è">
      <a href="/docs/attacks">
        <span>Attacks DB ‚öîÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tools db üõ†Ô∏è">
      <a href="/docs/tools">
        <span>Tools DB üõ†Ô∏è</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-ttp üîç">
      <a href="/docs/ttp">
        <span>TTP üîç</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db üè∫">
      <a href="/docs/artefacts">
        <span>Artefacts DB üè∫</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ‚öîÔ∏è">
      <a href="/docs/attacks">
        <span>Attacks DB ‚öîÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tools db üõ†Ô∏è">
      <a href="/docs/tools">
        <span>Tools DB üõ†Ô∏è</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> üëàüèº Back to </br> Blog ‚úçÔ∏è </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#evidence">Evidence</a></li>
    <li><a href="#scenario">Scenario</a></li>
    <li><a href="#questions">Questions</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">To Carry Out MockInv&#39;estigation. Part 1</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
              <i class="fab fa-windows"></i>          
            
            
            
            
            
            
          
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/whois">whois</a> 
          
           , 
          <a class="platform-link" href="/tools/ping">ping</a> 
          
           , 
          <a class="platform-link" href="/tools/autopsy">Autopsy</a> 
          
           , 
          <a class="platform-link" href="/tools/tcpdump">tcpdump</a> 
          
           , 
          <a class="platform-link" href="/tools/wireshark">Wireshark</a> 
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/spoiler" rel="tag">spoiler</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 25.04.2021
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>‚ùóSPOILER ALERT!</p>
<p>üìÜ <code>16/06/2021</code> , <em>Wednesday</em></p>
<p>üï∞ <code>09:21 PM</code>.</p>
<p><em>It was a very sunny day and a very nice a long walk that my daughter and I had before lunch. I feel uplifted because there is finally enough sun and green grass in my life! Unfortunately, no coffee today, since we don&rsquo;t have BonAcqua, which might be not the best for drinking, but is indeed one of the best to prepare coffee (quoting my husband).</em></p>
<p>Other users, who were given this challenge and had no prior forensics knowledge and experience apart from that acquired from the IBM course, compained that there were no instruction about this lab: which tools to use and how to move on. That&rsquo;s why I&rsquo;ve decided to add a short description to each evidence below.</p>
<h2 id="evidence">Evidence</h2>
<p>I am given several files. Two doc files about this lab. I am going to use them to structure this analysis.</p>
<ol>
<li>
<p>Hard Drive from suspect&rsquo;s computer = <em>FlashEvidence.001</em>. This format means that the disk image was acquired with EnCase software and to open it you need a special tool, not neccessarily <code>EnCase</code> itself. <code>Autopsy</code> is a free tool for the same purpose.</p>
</li>
<li>
<p>Packet Capture from activity on suspect&rsquo;s computer = <em>Evidence_Pcap.pcapng</em>. This file format means that this is a network capture and was acquired with either <code>tcpdump</code> or <code>Wireshark</code>. There might be other tools, but I don&rsquo;t know of them. These two are the most popular.</p>
</li>
<li>
<p>Registry from suspect&rsquo;s computer = <em>SAM hive</em>. The term <em>hive</em> in computer forensics usually applies to Windows registry. It is a collection of key-value configurations. SAM hive collects all user authentication information. To understand <a href="https://en.wikipedia.org/wiki/Security_Account_Manager">SAM</a>, you need to know about SIDs, RIDs, registry, LM/NTLM hashes. To view this file you&rsquo;ll need some tool like RegRipper (I guess). May be Autopsy allows viewing these files.</p>
</li>
<li>
<p>Browser file from alleged buyer&rsquo;s laptop = <em>j3uv3vkf.default</em>. This one I am not sure what is. I am going to google it when I feel the urge. I&rsquo;ve googled it, <code>j3uv3vkf.default</code> is the Profile. Judging from the files inside, it&rsquo;s a Firefox data. See <a href="/docs/articles/forensics/analysis/user-activity/network-activity/browser-forensics">here</a> to learn more about browser artifacts.</p>
</li>
</ol>
<p>Also, from the IR we have this is Inventory list of Product IDs of recently sold kidnapped stuffed animals: Product_E1, Product_P1, Product_D1, Product_R1.</p>
<h2 id="scenario">Scenario</h2>
<p>The Toy Story Police Department (TSPD) is investigating a series of kidnappings. Baby stuffed animals are being kidnapped from their homes and sold on the international stuffed slave market. Sheriff Woody raided the office of the suspected ringleader.  The Toy Story Incident Response (TSIR) team was able to perform data acquisition on found devices and computers. The suspect claims he is innocent and that any evidence found was planted on his computer.  TSPD has also captured a laptop from one of the alleged stuffed animal buyers. <strong>Your job is to analyze the acquired data and answer the questions in the attached document so that Sheriff Woody can bust this evil stuffed slave market.</strong></p>
<h2 id="questions">Questions</h2>
<p>I am going to fill this tables as the analysis goes on and I get more information.</p>
<h2 id="analysis">Analysis</h2>
<p>As with the vulnerability assessment, the first thing I am doing for approximately  an hour is applying <em>irrational</em> approach: following the intuition and openning files that I think might be of interest. I use this approach to get some clues, pivot points for methodical approach.</p>
<p>I&rsquo;ve decided to start with the <code>*.pcap</code> capture and get the low-hanging fruits: searching for keyword &ldquo;Product&rdquo; (since the sold animals are given an identifier like <code>Product_XY</code>) in the network connections using the following filter in Wireshark: <code>tcp contains Product</code>. Indeed there are lots of results, HTTP traffic only. Luckily, no SSL or I would not be able to see the contents. For example, <code>GET</code> request to <a href="http://globalstuffed.weebly.com/store/c1/Featured_Products.html">http://globalstuffed.weebly.com/store/c1/Featured_Products.html</a>. It is not browsable, unfortunately üòî.</p>
<p>Let&rsquo;s try pinging this domain:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping globalstuffed.weebly.com 
</span></span><span style="display:flex;"><span>PING pages-wildcard.weebly.com <span style="color:#f92672">(</span>199.34.228.54<span style="color:#f92672">)</span>: <span style="color:#ae81ff">56</span> data bytes
</span></span><span style="display:flex;"><span>Request timeout <span style="color:#66d9ef">for</span> icmp_seq <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Request timeout <span style="color:#66d9ef">for</span> icmp_seq <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>I know the IP now and can get some more information about this domain:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whois 199.34.228.54
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>NetRange:       199.34.228.0 - 199.34.231.255
</span></span><span style="display:flex;"><span>CIDR:           199.34.228.0/22
</span></span><span style="display:flex;"><span>NetName:        WEEBLYNET1
</span></span><span style="display:flex;"><span>NetHandle:      NET-199-34-228-0-1
</span></span><span style="display:flex;"><span>Parent:         NET199 <span style="color:#f92672">(</span>NET-199-0-0-0-0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>NetType:        Direct Assignment
</span></span><span style="display:flex;"><span>OriginAS:       AS27647
</span></span><span style="display:flex;"><span>Organization:   Weebly, Inc. <span style="color:#f92672">(</span>WEEBL-1<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Looks like Weebly is some hosting service. The website address (<a href="http://globalstuffed.weebly.com/">http://globalstuffed.weebly.com/</a>) and the records above suggest that. I&rsquo;m going to check this assumption. Yes, I was right. This is indeed a website builder. Our website (<a href="http://globalstuffed.weebly.com/)">http://globalstuffed.weebly.com/)</a>, however, is down.</p>
<p>The owner of the laptop claims that the evidence were planted. Generating the network traffic is possible without physical access to the device. So, we are looking for any indicators of compromise <em>before</em> these HTTP request.</p>
<p>So, it&rsquo;s time to make a timeline <a href="https://www.notion.so/Toy-PD-6dd1d00010cf4ebea0c1310307cd4f31">here</a> as my pivot point. In Wireshark I change date/time options for a more user-friendly one: <code>View - Time Display Options</code> and choose the first one. Now, I look at the first filtered request and put down the time of this event.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>1504	2015-07-17 02:16:00.486428	74.217.59.19	192.168.1.109	TCP	1514	<span style="color:#ae81ff">80</span> ‚Üí <span style="color:#ae81ff">14005</span> <span style="color:#f92672">[</span>ACK<span style="color:#f92672">]</span> Seq<span style="color:#f92672">=</span><span style="color:#ae81ff">2921</span> Ack<span style="color:#f92672">=</span><span style="color:#ae81ff">678</span> Win<span style="color:#f92672">=</span><span style="color:#ae81ff">15571</span> Len<span style="color:#f92672">=</span><span style="color:#ae81ff">1460</span> <span style="color:#f92672">[</span>TCP segment of a reassembled PDU<span style="color:#f92672">]</span> 
</span></span></code></pre></div><p>For simplicity sake I will assume that it happened this year (not to scroll all the way back). But I will preserve the day and time, of course.</p>
<p>üìÜ <code>17/06/2021</code> , <em>Thursday</em></p>
<p>üï∞ <code>07:14 PM</code></p>
<p>Got a little side-tracked, as if the universe doesn&rsquo;t want me to get smarter&hellip; . All of a sudden I can&rsquo;t create and rename folders on my PC and also (which might be connected) Autopsy is not working. I have to reset my PC to the dafault settings now, which will take some time, of course.</p>
<p>üï∞ <code>08:37 PM</code></p>
<p>I have reset my PC settings, installed several programs back and now it&rsquo;s working fine. Phew üò∞.</p>
<p>Opened Autopsy, created a new case following the instrunctions. Now I need to import an image. I&rsquo;m using the first option &ldquo;Disk or Image&rdquo; and browse to the <code>FlashEvidence.001</code> file. For modules I deselect all first, then select Recent Activity, Hash Lookup, File Type Identification, Keyword Search, Email Parser, Interesting Files Identifier, Central Repository, Data Source Integrity.</p>
<h2 id="references">References</h2>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
