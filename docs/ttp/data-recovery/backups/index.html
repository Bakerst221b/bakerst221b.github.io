<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backups - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/ttp/data-recovery/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ©» Data Recovery </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#-tools">ğŸ›  Tools</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Backups</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 12.07.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>*Most OS and apps have some sort of time machine, backups if you will. *</p>
<h2 id="windows">Windows</h2>
<p>ğŸ“‚ <code>\System Volume Information\</code></p>
<p>ğŸº <strong>Volume Shadow Copy</strong></p>
<h3 id="-tools">ğŸ›  Tools</h3>
<p><a href="https://coptr.digipres.org/index.php/Forensic_Acquisition_Utilities">https://coptr.digipres.org/index.php/Forensic_Acquisition_Utilities</a></p>
<p>ğŸ› ï¸ <code>KAPE</code> (removes duplicates) and ğŸ› ï¸ <code>Velociraptor</code> (scalable) can capture the VSC on a live system. ğŸ› ï¸ <code>Arsenal Image Mounter</code>, ğŸ› ï¸ <code>F-Response</code> and ğŸ› ï¸ <code>vshadowmount</code> can be used for a full-volume analysis.</p>
<p><a href="http://www.chrysocome.net/downloads/ddrelease64.exe"><code>dd.exe</code></a> for Windows. There used to be some FAU (Forensic Acquisition Utilities) package containing <code>dd</code>, but I could not find it, so I downloaded <code>dd.exe</code> separately.</p>
<p>To get the list of shadow copies from a PC, run the following built-in utility:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>vssadmin list shadows /<span style="color:#66d9ef">for</span>=&lt;path_to_drive&gt; <span style="color:#75715e"># /for=c: for a logial drive</span>
</span></span></code></pre></div><p>Now, to collect the image with a <code>dd</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>dd.exe <span style="color:#66d9ef">if</span>=\\.\HardDiskVolumeShadowCopy1 of=g:\shadow.img <span style="color:#75715e"># for Windows, using the above mentioned version of dd, we type `if` and `of` instead of `-if` and `-of`.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># what&#39;s --localwrt</span>
</span></span></code></pre></div><p>Better go and have a cup of coffee â˜•ï¸ since it takes a decent amount of time ğŸ•°, tick-tock!</p>
<p>ğŸ› ï¸ <code>libvshadow</code> is a library that can be used to process VSC, its components ğŸ› ï¸ <code>vshadowinfo</code> and ğŸ› ï¸ <code>vshadowmount</code> to help.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ğŸ“˜ vshadowinfo <span style="color:#f92672">[</span>-o NTFS_volume_offset<span style="color:#f92672">]</span> image_or_volume <span style="color:#75715e"># -o is optional, and only use when analysing a phisical drive, not a logical volume. </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If you have a E01 instead of a raw image file, use ewfmount utility first</span>
</span></span><span style="display:flex;"><span>ğŸ“˜ ewfmount image.E01 /mnt/mountname <span style="color:#75715e"># make the system see E01 as a raw disk</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ“˜ vshadowmount /mnt/mountname/submountname1 /mnt/vss <span style="color:#75715e"># mount all VSC at /mnt/vss</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ“˜ cd /mnt/vss <span style="color:#f92672">&amp;&amp;</span> ls <span style="color:#75715e"># list all available VSC</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ“˜ mount -o ro, loop, show_sys_files,streams_interface<span style="color:#f92672">=</span>windows vss2 /mnt/shadow_m/vss2 <span style="color:#75715e"># mount specific VSC. SIFT workstations now have an alias for this command: mountwin. ro - read-only. loop - This option is used when you&#39;re mounting a file that contains a file system, rather than a physical device. For example, this option is commonly used when mounting an ISO file. show_sys_files enables display of system files, which are normally hidden. The last option changes how NTFS Alternate Data Streams (ADS) are accessed, making it more like how they are accessed on a Windows system.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># you can automatically mount all the VSC availble with a loop</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i in vss*; <span style="color:#66d9ef">do</span> mountwin $i /mnt/shadow_m/$i; <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># run a timeline tool agains a VSC retrieved</span>
</span></span><span style="display:flex;"><span>ğŸ“˜ log2timeline.py plaso.dump imagefile
</span></span><span style="display:flex;"><span>ğŸ“˜ psort plaso.dump <span style="color:#75715e"># remove duplicates</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ“˜ fls -r -m C: <span style="color:#ae81ff">\\</span>.<span style="color:#ae81ff">\H</span>arddiskVolumeShadowCopy12 &gt;&gt; bodyfile <span style="color:#75715e"># can be used to analyse VSC, it&#39;s faster since it processes metadata only. </span>
</span></span><span style="display:flex;"><span>ğŸ“˜ log2timeline.pl -f mactime -w timeline.csv -Z UTC bodyfile <span style="color:#75715e"># convert </span>
</span></span></code></pre></div><h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <a href="http://journeyintoir.blogspot.com/2012/03/volume-shadow-copy-timeline.html">http://journeyintoir.blogspot.com/2012/03/volume-shadow-copy-timeline.html</a>
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
