<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ—„ File Systems - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/docs/ttp/data-recovery/file-systems/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
    <a href="/docs/ttp/data-recovery/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ©» Data Recovery </a>
  </p>
</div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          



 
 <h1 class="title">ğŸ—„ File Systems</h1> 
 

    <h2><a href="http://localhost:1313/docs/ttp/data-recovery/file-systems/fat/"> FAT Data Recovery</a></h2> 
    <p> <h2 id="fat32-file-recovery">FAT32 File Recovery</h2>
<p>First, get familiar with the FAT file system. There are some things specific to this FS in the way the files are created and deleted. We basically need to follow the file deletion steps in the reversed order.</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Change <code>0xE5</code> values in the directory entry set</li>
<li><input disabled="" type="checkbox"> Change FAT table values to indicate allocated (not <code>0x00000000</code>)</li>
<li><input disabled="" type="checkbox"> Use the short file name directory entry (starting cluster and file size)
<ul>
<li><input disabled="" type="checkbox"> Determine the cluster size using the volume boot record data</li>
<li><input disabled="" type="checkbox"> Calculate the number of clusters needed (<code>int clusters = file_size / cluster_size</code>). Keep in mind, that file size for folders is always <code>00 00 00 00</code>. So, don&rsquo;t confuse a file with a folder.</li>
<li><input disabled="" type="checkbox"> Rechain FAT entries of the file</li>
</ul>
</li>
</ul>
<blockquote>
<p>ğŸ” Intrestingly enough, this method worked on a FAT32 formatted flash drive. Why?</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/data-recovery/file-systems/ntfs/"> NTFS Data Recovery</a></h2> 
    <p> <h3 id="steps">Steps</h3>
<p>To get familiar with NTFS file creation and deletion, see <a href="/docs/dfir/data-storage/file-systems/ntfs#file-creation-and-deletion">here</a>. In general, there are resident and non-resident files. Resident files are small and have their contents in the MFT record itself. Non-resident files are bigger and their contents is stored elsewhere on the disk.</p>
<blockquote>
<p>âš ï¸ Since MFT records get reused once they are deallocated on the first-free basis, resident files get overwritten sooner.</p></blockquote>
<p>For resident files, use a regular expression for finding <code>FILE0</code> records: <code>\x46\x49\x4C\x45.{18}[\x00\x02]</code> [<a href="https://www.coursera.org/learn/windows-os-forensics/lecture/VMUiU/ntfs-file-recovery">2</a>]. This will find all the <code>FILE</code> records that are not newly created. Remember, once a file is created its sequence number is <code>01</code>. Whenever the <code>FILE</code> record is deleted (deallocated, it&rsquo;s never actually deleted), the sequence number gets incremented. So, if this record was deallocated once, its sequence number will be <code>0x02</code>. But! This record can be reused multiple times! When I did the lab, one poor record was reused over and over again, and its sequence number got as big as <code>0x08</code>, imagine that! So, I would fix the regular expression above to address these cases: <code>\x46\x49\x4C\x45.{18}^[\x00\x01]</code> (todo).</p></p>





        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/docs/ttp/data-recovery/file-systems/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
