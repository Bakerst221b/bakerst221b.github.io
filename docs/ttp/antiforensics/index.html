<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•¶ï¸ Anti-Forensics - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.0fd8269b84d57bc40ce18bb200a70ca7e1001ccf31f98dc3a8e47fa25f99b326.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/ttp/antiforensics/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
    <a href="/docs/ttp/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ” Investigation Tactics Techniques and Procedures </a>
  </p>
</div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          



 
 <h1 class="title">ğŸ•¶ï¸ Anti-Forensics</h1> 
 

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/techniques/"> Anti-Forensics Techniques</a></h2> 
    <p> <p><em>This article is an overview of possible anti-forensics.</em></p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/process-hiding/"> Hiding Processes</a></h2> 
    <p> <p>Malware is not going to just always sit there and sing ğŸ¶. Below are common techniques. More detailed explanation is in the anti-forensics section.</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/forged-images/"> Forged Image Detection</a></h2> 
    <p> <p><a href="https://29a.ch/photo-forensics/#forensic-magnifier">https://29a.ch/photo-forensics/#forensic-magnifier</a></p>
<p>Images can be forged or cloned. Regions can be manipulated with. Hard to detect with naked eye. &#x2757; Social Media strips-off metadata from uploaded images which makes tracking of the image difficult.</p>
<p>Main goals are: detect whether the image was cloned and track the source of the image. Forensically and JPEGSnoop open-source tools.  They detect tampering.</p>
<ol>
<li><strong>Magnification</strong>. <code>Autocontrast</code> will not disturb the colors too much. <code>Autocontrast by channel</code> will.</li>
<li><strong>Clone Detection</strong>. The most important. <code>Minimal similariyt</code> ~ <code>0.5</code>. <code>Minimal detail</code> ~ <code>0.1</code>. <code>Minimal cluster size</code> - the number of blocks that two regions need to share in order to be considered clones ~ <code>14</code>.</li>
<li><strong>Error-level analysis</strong>. Tells that something was compressed multiple times. For example, when you paste an image on another image and save, the are several compressions in place: for the original image and for the pasted one. Use noise to determine that. Spot the artifacts that have been implanted on an image by compressing it multiple times. Because of the noise these parts can&rsquo;t be compressed much.</li>
<li><strong>Noise analysis</strong>. Self-explanatory.</li>
<li><strong>JPEG analysis</strong>. Computes the Quantization table, which specify the way an image has been compressed. Each cell <code>0-255</code>.  To compress an image the pixel intestines are modified by the software app in the range of <code>-128</code> to <code>127</code> and new quantization table is calculated. The value of standart - <code>95</code>, which is auto value when the image is not processed. Adobe (Photoshop quality) uses <code>85</code>. The order of different sections. <code>SOI</code> - image start,  <code>EOI</code>- end of image. Multiple <code>SOI</code> and <code>EOI</code> are indicative of pasting other images. Application segments, <code>APP0</code>(JPEG version, screen and printing resolution), <code>APP1</code> (date/time, focal length, aperture), <code>APP13</code> (if processed with Adobe Photoshop). <code>SOS</code> - image was compressed.</li>
<li><strong>Structural and String Analysis</strong>. When there is no EXIF is useful. <code>FBMD01000a9...</code> indicated web upload (Facebook).</li>
</ol>
<p><img src="osdf-fakeimages1.png" alt="osdf-fakeimages1"></p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/antivirus/"> Evading Antivirus</a></h2> 
    <p> <h2 id="windows">Windows</h2>
<p><a href="https://tyeyeah.github.io/2021/08/02/2021-08-02-Bypass-Anti-Virus/">https://tyeyeah.github.io/2021/08/02/2021-08-02-Bypass-Anti-Virus/</a></p>
<h2 id="macos">macOS</h2>
<h2 id="linux">Linux</h2></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/fs-hiding-data/"> Hiding Data</a></h2> 
    <p> <h2 id="alternative-data-stream">Alternative data stream</h2>
<p>Alternate data streams. Specific for Windows. See more <a href="/docs/dfir/forensic-investigation/reference/windows/win-ads">here</a>. Are there such streams for other OS? If yes, how to make them and discover them?</p>
<p>To ensure compatability between NTFS and HFS. Allows hiding files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>C:\type C:\mal.exe &gt; C:\readme.txt<span style="color:#960050;background-color:#1e0010">:</span>naughty.exe
</span></span><span style="display:flex;"><span>start readme.txt<span style="color:#960050;background-color:#1e0010">:</span>naughty.exe
</span></span><span style="display:flex;"><span>C:\mklink innocent.exe readme.txt<span style="color:#960050;background-color:#1e0010">:</span>naughty.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># to run</span>
</span></span><span style="display:flex;"><span>innocent.exe
</span></span></code></pre></div><p>But <code>dir /r</code> - will display <strong>all</strong> streams. LNS and Sfind will hunt down such files. Also, when you copy files from and to a FAT partition - all residual files will be deleted.</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/logs-turnoff/"> Turning Off Logging</a></h2> 
    <p> <h2 id="macos">macOS</h2>
<p>From Apple&rsquo;s official documentation:</p>
<blockquote>
<p>In some cases, the contents of a volume are sufficiently secret that it is not appropriate to log them. To disable logging on a per-volume basis (for creating a backup volume, for example), you must do the following:</p>
<ul>
<li><input disabled="" type="checkbox"> Create a <code>.fseventsd</code> directory at the top level of the volume.</li>
<li><input disabled="" type="checkbox"> Create an empty <code>no_log</code> file in that directory.</li>
</ul>
<p>So if your volume is mounted at <code>/Volumes/MyDisk</code>, you would create an empty file called <code>/Volumes/MyDisk/.fseventsd/no_log</code>.</p></p>

    <h2><a href="https://bakerst221b.com/docs/ttp/antiforensics/usbkill-switch/"> USBKill Switch</a></h2> 
    <p> <p>A software that could be used for anti-forensics. By default, configs are at <code>/etc</code> and named <code>usbkill.ini</code>. The default behaviour - shut the system down. Keeps a whitelist of allowed USB devices. Can also prevent malware from getting on the PC from a USB drive.</p>
<p>Analogues: BusKill (set a <code>udev</code> rule to be triggered if the USB drive is removed: lock, shutdown or self-destruct) and Silk Guardian (Linux Kernel mode switch that&rsquo;s waiting for a change, deletes files on events and shuts the system down).</p></p>





        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="https://bakerst221b.com/docs/ttp/antiforensics/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js"></script>
  

  
  
  
    
  


</body>

</html>
