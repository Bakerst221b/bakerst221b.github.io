<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸª› Reverse Engineering - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="http://localhost:1313/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>

<body class='page page-default-list'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="http://localhost:1313/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/docs/ttp/malware/analyse/index.xml" title="Analyst" />
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/artefacts">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/attacks">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
    <a href="/docs/ttp/malware/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ”¬ Malware Analysis </a>
  </p>
</div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          



 
 <h1 class="title">ğŸª› Reverse Engineering</h1> 
 

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/basics/"> ğŸ“š Basics</a></h2> 
    <p> <p><em>During forensics investigation it&rsquo;s sometimes needed to reverse engineer some suspicious piece of code. This section is a reverse engineering dive-in section.</em></p>
<h2 id="librariries-and-methods">Librariries and Methods</h2>
<table>
  <thead>
      <tr>
          <th>Library</th>
          <th>common use</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>kernell32.dll</code>, <code>advapi.dll</code>, <code>ntdll.dll</code></td>
          <td>These three libraries are used for communicating with the kernel and basic functions, like openinng files, creating proccessing, manipulating hardware etc. <code>advapi.dll</code> is for advanced functionality like registry and service manager. <code>ntdll.dll</code> is pretty much the same as <code>kernell32.dll</code> (since the latter used the former in its imports) but more low-level and advanced. It&rsquo;s rarely imported directly, usually, <code>kernell32.dll</code> imports it. Its direct import might be an indicator of hiding functionality.</td>
      </tr>
      <tr>
          <td><code>user32.dll</code>, <code>gdi32.dll</code></td>
          <td>These are for GUI. <code>user32.dll</code> is for buttons and stuff, while <code>gdi32.dll</code> is for general graphics settings.</td>
      </tr>
      <tr>
          <td><code>WSock32.dll</code>, <code>ws2_32.dll</code>, <code>wininet.dll</code></td>
          <td><code>WSock32.dll</code> and <code>ws2_32.dll</code> are for general networing functionality like opening sockets, while <code>wininet.dll</code> is more high-level (FTP, HTTP, NTP protocols etc).</td>
      </tr>
  </tbody>
</table>
<h2 id="naming-conventions">Naming conventions</h2>
<ul>
<li>On Windows systems some functions have a suffix <code>A</code> or <code>W</code>. These indicate that this function accepting ASCII or wide character string as an argument respectively.</li>
<li>On Windows systems some functions have a suffix <code>Ex</code> or even <code>ExEx</code>. These indicate that Windows has released a new version of a function which is not compatible with older ones, since older ones must be supported.</li>
</ul>
<h2></h2></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/executables/"> ğŸ©» Anatomy Of Executables</a></h2> 
    <p> </p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/packing/"> ğŸ Packed Executables And Unpacking</a></h2> 
    <p> <p>There are several indicators that the executable is packed. Here they are (this list will be growing as I encounter new indicators):</p>
<ul>
<li>Few imports and among these imports are functions like <code>GetProcessAddress</code> or <code>LoadLibrary</code></li>
<li>Weird names for PE sections</li>
<li>Empty Physical addresses for sections (while VA is not empty). More about</li>
</ul>
<h2 id="unpacking-techniques">Unpacking techniques</h2>
<p>A piece of software cannot just run packed (what a challenging world that would be! ğŸ˜³ ). The thing is that whatever the packing algorithm is, however complex ğŸ§¶ it might be, the real code needs to be <em>unpacked into memory</em> first. So, even with the most sophisticated protection techniques, it all really comes down to waiting for the executable to get unpacked into memory, from where it can be gently and dearly dumped like a ğŸ hive from a tree ğŸŒ³ full of hungry and pretty aggressive wild bees with a big and heavy bat ğŸƒâ€â™€ï¸. We might want to do some minor other stuff afterwards but let&rsquo;s keep it for now.</p></p>

    <h2><a href="http://localhost:1313/docs/ttp/malware/analyse/binary-analysis/"> ğŸ’± Symbolic and Concrete Execution</a></h2> 
    <p> <h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>[<a href="https://mobile-security.gitbook.io/mobile-security-testing-guide/android-testing-guide/0x05h-testing-platform-interaction#testing-for-fragment-injection-mstg-platform-2">1</a>] Mobile Sec Guide</p>
<p>[<a href="https://www.nowsecure.com/blog/2021/03/10/how-to-perform-symbolic-execution-of-mobile-apps-with-r2frida-esilsolve/">2</a>] Symbolic execution on iOS with R2Frida &amp; ESILSolve</p>
<p>[<a href="https://www.nowsecure.com/blog/2021/03/10/how-to-perform-symbolic-execution-of-mobile-apps-with-r2frida-esilsolve/">3</a>] Symbolic execution on iOS)] Concrete execution on iOS with Angr.</p>
<p>[<a href="https://www.nowsecure.com/blog/2021/03/10/how-to-perform-symbolic-execution-of-mobile-apps-with-r2frida-esilsolve/">4</a>)] Symbolic execution on Android with Angr.
[<a href="https://paper.bobylive.com/Security/A%20Bug%20Hunter%20%20039%20s%20Diary%20%20A%20Guided%20Tour%20Through%20the%20Wilds%20of%20Software%20Security.pdf">5</a>] A Bug Hunter&rsquo;s Diary: A Guided Tour Through the Wilds of Software Security, by Tobias Klein.</p>

</details></p>





        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/docs/ttp/malware/analyse/index.xml" title="Analyst" />
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.js"></script>
  

  


</body>

</html>
